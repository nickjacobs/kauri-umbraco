tinyMCE.importPluginLanguagePack("umbracomacro","en,tr,he,nb,ru,ru_KOI8-R,ru_UTF-8,nn,fi,cy,es,is,pl");var TinyMCE_UmbracomacroPlugin={getInfo:function(){return{longname:"umbracomacro",author:"Your name",authorurl:"http://www.yoursite.com",infourl:"http://www.yoursite.com/docs/template.html",version:"1.0"}},initInstance:function(A){if(!tinyMCE.settings.flash_skip_plugin_css){tinyMCE.importCSS(A.getDoc(),tinyMCE.baseURL+"/plugins/umbracomacro/css/content.css")}},getControlHTML:function(A){switch(A){case"umbracomacro":return tinyMCE.getButtonHTML(A,"lang_macro_desc","{$pluginurl}/images/macro.gif","mceUmbracomacro",true)}return""},execCommand:function(J,F,D,A,K){switch(D){case"mceUmbracomacro":var L=new Array();L.file="../../../.."+tinyMCE.settings.umbracoPath+"/plugins/tinymce/insertMacro.aspx?editor=true&umbPageId="+umbPageId+"&umbVersionId="+umbVersionId;L.width=600;L.height=550;var G=tinyMCE.getInstanceById(J);var M=G.getFocusElement();var C=null;if(M!=null){do{if(M.nodeName=="DIV"&&tinyMCE.getAttrib(M,"class").indexOf("umbMacroHolder")>=0){C=M;G.selection.selectNode(M,true,true)}}while((M=M.parentNode));if(C!=null){var B=C;L.file="../../../../umbraco/plugins/tinymce/insertMacro.aspx?mode=edit&";var H="";var I="";for(var E=0;E<B.attributes.length;E++){I=B.attributes[E].nodeName.toLowerCase();if(I!="mce_serialized"){if(B.attributes[E].nodeValue&&(I!="ismacro"&&I!="style"&&I!="contenteditable")){H+=B.attributes[E].nodeName+"="+B.attributes[E].nodeValue.replace(/#/g,"%23").replace(/\</g,"%3C").replace(/\>/g,"%3E").replace(/\"/g,"%22")+"&"}}}if(H.length>0){H=H.substr(0,H.length-1)}L.file+=H}else{if(K!=null&&K!=""){L.file+="&umb_macroAlias="+K}}}tinyMCE.openWindow(L,{editor_id:J,scrollbars:"yes",some_custom_arg:"somecustomdata"});tinyMCE.triggerNodeChange(false);return true}return false},handleNodeChange:function(F,D,E,C,A,B){if(D==null){return}do{if(D.nodeName=="DIV"&&tinyMCE.getAttrib(D,"class").indexOf("umbMacroHolder")>=0){tinyMCE.switchClass(F+"_umbracomacro","mceButtonSelected");return true}}while((D=D.parentNode));tinyMCE.switchClass(F+"_umbracomacro","mceButtonNormal");return true},setupContent:function(C,A,B){},onChange:function(A){},handleEvent:function(A){return true},cleanup:function(A,B,C){return B;switch(A){case"get_from_editor":break;case"insert_to_editor":break;case"get_from_editor_dom":break;case"insert_to_editor_dom":break}return B},_someInternalFunction:function(B,A){return 1}};tinyMCE.addPlugin("umbracomacro",TinyMCE_UmbracomacroPlugin);