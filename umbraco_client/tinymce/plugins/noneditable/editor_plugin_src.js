var TinyMCE_NonEditablePlugin={getInfo:function(){return{longname:"Non editable elements",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://tinymce.moxiecode.com/tinymce/docs/plugin_noneditable.html",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}},initInstance:function(A){tinyMCE.importCSS(A.getDoc(),tinyMCE.baseURL+"/plugins/noneditable/css/noneditable.css");if(tinyMCE.isMSIE5_0){tinyMCE.settings.plugins=tinyMCE.settings.plugins.replace(/noneditable/gi,"Noneditable")}},handleEvent:function(A){return this._moveSelection(A,tinyMCE.selectedInstance)},cleanup:function(I,F,D){switch(I){case"insert_to_editor_dom":if(tinyMCE.isGecko){return F}var A=tinyMCE.getNodeTree(F,new Array(),1),C,E,J;E=tinyMCE.getParam("noneditable_editable_class","mceEditable");J=tinyMCE.getParam("noneditable_noneditable_class","mceNonEditable");for(C=0;C<A.length;C++){var H=A[C];var B=tinyMCE.getAttrib(H,"contenteditable");if(new RegExp("true|false","gi").test(B)){TinyMCE_NonEditablePlugin._setEditable(H,B=="true")}if(tinyMCE.isMSIE){var G=H.className?H.className:"";if(G.indexOf(E)!=-1){H.contentEditable=true}if(G.indexOf(J)!=-1){H.contentEditable=false}}}break;case"insert_to_editor":var E=tinyMCE.getParam("noneditable_editable_class","mceEditable");var J=tinyMCE.getParam("noneditable_noneditable_class","mceNonEditable");F=F.replace(/mceItemEditable/g,E);F=F.replace(/mceItemNonEditable/g,J);if(tinyMCE.isIE){F=F.replace(new RegExp('class="(.*)('+E+')([^"]*)"',"gi"),'class="$1$2$3" contenteditable="true"');F=F.replace(new RegExp('class="(.*)('+J+')([^"]*)"',"gi"),'class="$1$2$3" contenteditable="false"')}break;case"get_from_editor_dom":if(tinyMCE.isGecko){return F}if(tinyMCE.getParam("noneditable_leave_contenteditable",false)){var A=tinyMCE.getNodeTree(F,new Array(),1);for(var C=0;C<A.length;C++){A[C].removeAttribute("contenteditable")}}break}return F},_moveSelection:function(F,E){var C,D,G,A,B,H=tinyMCE.getParam("noneditable_editable_class","mceNonEditable");if(!E){return true}if(tinyMCE.isGecko){C=E.selection.getSel();alert(C);D=C.getRangeAt(0);G=tinyMCE.getParentNode(D.startContainer,function(I){return tinyMCE.hasCSSClass(I,H)});A=tinyMCE.getParentNode(D.endContainer,function(I){return tinyMCE.hasCSSClass(I,H)});G&&D.setStartBefore(G);A&&D.setEndAfter(A);if(G||A){if(F.type=="keypress"&&F.keyCode==39){B=G||A}C.removeAllRanges();C.addRange(D);return tinyMCE.cancelEvent(F)}}return true},_setEditable:function(E,D){var B=tinyMCE.getParam("noneditable_editable_class","mceEditable");var A=tinyMCE.getParam("noneditable_noneditable_class","mceNonEditable");var C=E.className?E.className:"";if(C.indexOf(B)!=-1||C.indexOf(A)!=-1){return}if((C=tinyMCE.getAttrib(E,"class"))!=""){C+=" "}C+=D?B:A;E.setAttribute("class",C);E.className=C}};tinyMCE.addPlugin("noneditable",TinyMCE_NonEditablePlugin);