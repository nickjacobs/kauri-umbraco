tinyMCE.importThemeLanguagePack("advanced");var TinyMCE_AdvancedTheme={_defColors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",_autoImportCSSClasses:true,_resizer:{},_buttons:[["bold","{$lang_bold_img}","lang_bold_desc","Bold"],["italic","{$lang_italic_img}","lang_italic_desc","Italic"],["underline","{$lang_underline_img}","lang_underline_desc","Underline"],["strikethrough","strikethrough.gif","lang_striketrough_desc","Strikethrough"],["justifyleft","justifyleft.gif","lang_justifyleft_desc","JustifyLeft"],["justifycenter","justifycenter.gif","lang_justifycenter_desc","JustifyCenter"],["justifyright","justifyright.gif","lang_justifyright_desc","JustifyRight"],["justifyfull","justifyfull.gif","lang_justifyfull_desc","JustifyFull"],["bullist","bullist.gif","lang_bullist_desc","InsertUnorderedList"],["numlist","numlist.gif","lang_numlist_desc","InsertOrderedList"],["outdent","outdent.gif","lang_outdent_desc","Outdent"],["indent","indent.gif","lang_indent_desc","Indent"],["cut","cut.gif","lang_cut_desc","Cut"],["copy","copy.gif","lang_copy_desc","Copy"],["paste","paste.gif","lang_paste_desc","Paste"],["undo","undo.gif","lang_undo_desc","Undo"],["redo","redo.gif","lang_redo_desc","Redo"],["link","link.gif","lang_link_desc","mceLink",true],["unlink","unlink.gif","lang_unlink_desc","unlink"],["image","image.gif","lang_image_desc","mceImage",true],["cleanup","cleanup.gif","lang_cleanup_desc","mceCleanup"],["help","help.gif","lang_help_desc","mceHelp"],["code","code.gif","lang_theme_code_desc","mceCodeEditor"],["hr","hr.gif","lang_theme_hr_desc","inserthorizontalrule"],["removeformat","removeformat.gif","lang_theme_removeformat_desc","removeformat"],["sub","sub.gif","lang_theme_sub_desc","subscript"],["sup","sup.gif","lang_theme_sup_desc","superscript"],["forecolor","forecolor.gif","lang_theme_forecolor_desc","forecolor",true],["backcolor","backcolor.gif","lang_theme_backcolor_desc","HiliteColor",true],["charmap","charmap.gif","lang_theme_charmap_desc","mceCharMap"],["visualaid","visualaid.gif","lang_theme_visualaid_desc","mceToggleVisualAid"],["anchor","anchor.gif","lang_theme_anchor_desc","mceInsertAnchor"],["newdocument","newdocument.gif","lang_newdocument_desc","mceNewDocument"]],_buttonMap:"anchor,backcolor,bold,bullist,charmap,cleanup,code,copy,cut,forecolor,help,hr,image,indent,italic,justifycenter,justifyfull,justifyleft,justifyright,link,newdocument,numlist,outdent,paste,redo,removeformat,strikethrough,sub,sup,underline,undo,unlink,visualaid,advhr,ltr,rtl,emotions,flash,fullpage,fullscreen,iespell,insertdate,inserttime,pastetext,pasteword,selectall,preview,print,save,replace,search,table,cell_props,delete_col,delete_row,col_after,col_before,row_after,row_before,merge_cells,row_props,split_cells,delete_table",getControlHTML:function(H){var E,L,G;for(E=0;E<TinyMCE_AdvancedTheme._buttons.length;E++){G=TinyMCE_AdvancedTheme._buttons[E];if(G[0]==H&&(H=="forecolor"||H=="backcolor")){return tinyMCE.getMenuButtonHTML(G[0],G[2],"{$themeurl}/images/"+G[1],G[3]+"Menu",G[3],(G.length>4?G[4]:false),(G.length>5?G[5]:null))}if(G[0]==H){return tinyMCE.getButtonHTML(G[0],G[2],"{$themeurl}/images/"+G[1],G[3],(G.length>4?G[4]:false),(G.length>5?G[5]:null))}}switch(H){case"umbracoformatselector":return"<select id=\"{$editor_id}_umbracoFormatSelect\" onmousedown=\"tinyMCE.themes.advanced._setupCSSClasses('{$editor_id}');\" name=\"{$editor_id}_styleSelect\" onfocus=\"tinyMCE.addSelectAccessibility(event,this,window);\" onchange=\"if (this.options[this.selectedIndex].value != '' && this.options[this.selectedIndex].value.indexOf('.') == 0) {tinyMCE.execInstanceCommand('{$editor_id}','mceSetCSSClass',false,this.options[this.selectedIndex].value.substring(1, this.options[this.selectedIndex].value.length)); }else if (this.options[this.selectedIndex].value != '') { tinyMCE.execInstanceCommand('{$editor_id}','FormatBlock',false,this.options[this.selectedIndex].value); } else {tinyMCE.execInstanceCommand('{$editor_id}','mceSetCSSClass',false,''); tinyMCE.execInstanceCommand('{$editor_id}','FormatBlock',false,'&lt;p&gt;'); } \" class=\"mceSelectList\">{$style_select_options}</select>";case"formatselect":var F='<select id="{$editor_id}_formatSelect" name="{$editor_id}_formatSelect" onfocus="tinyMCE.addSelectAccessibility(event, this, window);" onchange="tinyMCE.execInstanceCommand(\'{$editor_id}\',\'FormatBlock\',false,this.options[this.selectedIndex].value);" class="mceSelectList">';var K=tinyMCE.getParam("theme_advanced_blockformats","p,address,pre,h1,h2,h3,h4,h5,h6",true).split(",");var B=[["p","{$lang_theme_paragraph}"],["address","{$lang_theme_address}"],["pre","{$lang_theme_pre}"],["h1","{$lang_theme_h1}"],["h2","{$lang_theme_h2}"],["h3","{$lang_theme_h3}"],["h4","{$lang_theme_h4}"],["h5","{$lang_theme_h5}"],["h6","{$lang_theme_h6}"],["div","{$lang_theme_div}"],["blockquote","{$lang_theme_blockquote}"],["code","{$lang_theme_code}"],["dt","{$lang_theme_dt}"],["dd","{$lang_theme_dd}"],["samp","{$lang_theme_samp}"]];F+='<option value="">{$lang_theme_block}</option>';for(var E=0;E<K.length;E++){for(var L=0;L<B.length;L++){if(K[E]==B[L][0]){F+='<option value="&lt;'+B[L][0]+'&gt;">'+B[L][1]+"</option>"}}}F+="</select>";return F;case"styleselect":return'<select id="{$editor_id}_styleSelect" onmousedown="tinyMCE.themes.advanced._setupCSSClasses(\'{$editor_id}\');" name="{$editor_id}_styleSelect" onfocus="tinyMCE.addSelectAccessibility(event,this,window);" onchange="alert(this.options[this.selectedIndex].value);tinyMCE.execInstanceCommand(\'{$editor_id}\',\'mceSetCSSClass\',false,this.options[this.selectedIndex].value);" class="mceSelectList">{$style_select_options}</select>';case"fontselect":var A='<select id="{$editor_id}_fontNameSelect" name="{$editor_id}_fontNameSelect" onfocus="tinyMCE.addSelectAccessibility(event, this, window);" onchange="tinyMCE.execInstanceCommand(\'{$editor_id}\',\'FontName\',false,this.options[this.selectedIndex].value);" class="mceSelectList"><option value="">{$lang_theme_fontdefault}</option>';var J="Arial=arial,helvetica,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,times new roman,times,serif;Tahoma=tahoma,arial,helvetica,sans-serif;Times New Roman=times new roman,times,serif;Verdana=verdana,arial,helvetica,sans-serif;Impact=impact;WingDings=wingdings";var C="Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sand;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats";var I=tinyMCE.getParam("theme_advanced_fonts",C).split(";");for(E=0;E<I.length;E++){if(I[E]!=""){var D=I[E].split("=");A+='<option value="'+D[1]+'">'+D[0]+"</option>"}}A+="</select>";return A;case"fontsizeselect":return'<select id="{$editor_id}_fontSizeSelect" name="{$editor_id}_fontSizeSelect" onfocus="tinyMCE.addSelectAccessibility(event, this, window);" onchange="tinyMCE.execInstanceCommand(\'{$editor_id}\',\'FontSize\',false,this.options[this.selectedIndex].value);" class="mceSelectList"><option value="0">{$lang_theme_font_size}</option><option value="1">1 (8 pt)</option><option value="2">2 (10 pt)</option><option value="3">3 (12 pt)</option><option value="4">4 (14 pt)</option><option value="5">5 (18 pt)</option><option value="6">6 (24 pt)</option><option value="7">7 (36 pt)</option></select>';case"|":case"separator":return'<img src="{$themeurl}/images/separator.gif" width="2" height="20" class="mceSeparatorLine" />';case"spacer":return'<img src="{$themeurl}/images/separator.gif" width="2" height="15" border="0" class="mceSeparatorLine" style="vertical-align: middle" />';case"rowseparator":return"<br />"}return""},execCommand:function(editor_id,element,command,user_interface,value){switch(command){case"mceHelp":tinyMCE.openWindow({file:"about.htm",width:480,height:380},{tinymce_version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion,tinymce_releasedate:tinyMCE.releaseDate,inline:"yes"});return true;case"mceLink":var inst=tinyMCE.getInstanceById(editor_id);var doc=inst.getDoc();var selectedText="";if(tinyMCE.isMSIE){var rng=doc.selection.createRange();selectedText=rng.text}else{selectedText=inst.getSel().toString()}if(!tinyMCE.linkElement){if((tinyMCE.selectedElement.nodeName.toLowerCase()!="img")&&(selectedText.length<=0)){return true}}var href="",target="",title="",onclick="",action="insert",style_class="";if(tinyMCE.selectedElement.nodeName.toLowerCase()=="a"){tinyMCE.linkElement=tinyMCE.selectedElement}if(tinyMCE.linkElement!=null&&tinyMCE.getAttrib(tinyMCE.linkElement,"href")==""){tinyMCE.linkElement=null}if(tinyMCE.linkElement){href=tinyMCE.getAttrib(tinyMCE.linkElement,"href");target=tinyMCE.getAttrib(tinyMCE.linkElement,"target");title=tinyMCE.getAttrib(tinyMCE.linkElement,"title");onclick=tinyMCE.getAttrib(tinyMCE.linkElement,"onclick");style_class=tinyMCE.getAttrib(tinyMCE.linkElement,"class");if(onclick==""){onclick=tinyMCE.getAttrib(tinyMCE.linkElement,"onclick")}onclick=tinyMCE.cleanupEventStr(onclick);href=eval(tinyMCE.settings.urlconverter_callback+"(href, tinyMCE.linkElement, true);");mceRealHref=tinyMCE.getAttrib(tinyMCE.linkElement,"mce_href");if(mceRealHref!=""){href=mceRealHref;if(tinyMCE.getParam("convert_urls")){href=eval(tinyMCE.settings.urlconverter_callback+"(href, tinyMCE.linkElement, true);")}}action="update"}var template=new Array();template.file="link.htm";template.width=310;template.height=200;template.width+=tinyMCE.getLang("lang_insert_link_delta_width",0);template.height+=tinyMCE.getLang("lang_insert_link_delta_height",0);if(inst.settings.insertlink_callback){var returnVal=eval(inst.settings.insertlink_callback+"(href, target, title, onclick, action, style_class);");if(returnVal&&returnVal.href){TinyMCE_AdvancedTheme._insertLink(returnVal.href,returnVal.target,returnVal.title,returnVal.onclick,returnVal.style_class)}}else{tinyMCE.openWindow(template,{href:href,target:target,title:title,onclick:onclick,action:action,className:style_class,inline:"yes"})}return true;case"mceImage":var src="",alt="",border="",hspace="",vspace="",width="",height="",align="";var title="",onmouseover="",onmouseout="",action="insert";var img=tinyMCE.imgElement;var inst=tinyMCE.getInstanceById(editor_id);if(tinyMCE.selectedElement!=null&&tinyMCE.selectedElement.nodeName.toLowerCase()=="img"){img=tinyMCE.selectedElement;tinyMCE.imgElement=img}if(img){if(tinyMCE.getAttrib(img,"name").indexOf("mce_")==0){return true}src=tinyMCE.getAttrib(img,"src");alt=tinyMCE.getAttrib(img,"alt");if(alt==""){alt=tinyMCE.getAttrib(img,"title")}if(tinyMCE.isGecko){var w=img.style.width;if(w!=null&&w!=""){img.setAttribute("width",w)}var h=img.style.height;if(h!=null&&h!=""){img.setAttribute("height",h)}}border=tinyMCE.getAttrib(img,"border");hspace=tinyMCE.getAttrib(img,"hspace");vspace=tinyMCE.getAttrib(img,"vspace");width=tinyMCE.getAttrib(img,"width");height=tinyMCE.getAttrib(img,"height");align=tinyMCE.getAttrib(img,"align");onmouseover=tinyMCE.getAttrib(img,"onmouseover");onmouseout=tinyMCE.getAttrib(img,"onmouseout");title=tinyMCE.getAttrib(img,"title");if(tinyMCE.isMSIE){width=img.attributes.width.specified?width:"";height=img.attributes.height.specified?height:""}src=eval(tinyMCE.settings.urlconverter_callback+"(src, img, true);");mceRealSrc=tinyMCE.getAttrib(img,"mce_src");if(mceRealSrc!=""){src=mceRealSrc;if(tinyMCE.getParam("convert_urls")){src=eval(tinyMCE.settings.urlconverter_callback+"(src, img, true);")}}action="update"}var template=new Array();template.file="image.htm?src={$src}";template.width=355;template.height=265+(tinyMCE.isMSIE?25:0);template.width+=tinyMCE.getLang("lang_insert_image_delta_width",0);template.height+=tinyMCE.getLang("lang_insert_image_delta_height",0);if(inst.settings.insertimage_callback){var returnVal=eval(inst.settings.insertimage_callback+"(src, alt, border, hspace, vspace, width, height, align, title, onmouseover, onmouseout, action);");if(returnVal&&returnVal.src){TinyMCE_AdvancedTheme._insertImage(returnVal.src,returnVal.alt,returnVal.border,returnVal.hspace,returnVal.vspace,returnVal.width,returnVal.height,returnVal.align,returnVal.title,returnVal.onmouseover,returnVal.onmouseout)}}else{tinyMCE.openWindow(template,{src:src,alt:alt,border:border,hspace:hspace,vspace:vspace,width:width,height:height,align:align,title:title,onmouseover:onmouseover,onmouseout:onmouseout,action:action,inline:"yes"})}return true;case"forecolor":var fcp=new TinyMCE_Layer(editor_id+"_fcPreview",false),p,img,elm;TinyMCE_AdvancedTheme._hideMenus(editor_id);if(!fcp.exists()){fcp.create("div","mceColorPreview",document.getElementById(editor_id+"_toolbar"));elm=fcp.getElement();elm._editor_id=editor_id;elm._command="forecolor";elm._switchId=editor_id+"_forecolor";tinyMCE.addEvent(elm,"click",TinyMCE_AdvancedTheme._handleMenuEvent);tinyMCE.addEvent(elm,"mouseover",TinyMCE_AdvancedTheme._handleMenuEvent);tinyMCE.addEvent(elm,"mouseout",TinyMCE_AdvancedTheme._handleMenuEvent)}img=tinyMCE.selectNodes(document.getElementById(editor_id+"_forecolor"),function(n){return n.nodeName=="IMG"})[0];p=tinyMCE.getAbsPosition(img,document.getElementById(editor_id+"_toolbar"));fcp.moveTo(p.absLeft,p.absTop);fcp.getElement().style.backgroundColor=value!=null?value:tinyMCE.getInstanceById(editor_id).foreColor;fcp.show();return false;case"forecolorMenu":TinyMCE_AdvancedTheme._hideMenus(editor_id);var ml=new TinyMCE_Layer(editor_id+"_fcMenu");if(!ml.exists()){ml.create("div","mceMenu",document.body,TinyMCE_AdvancedTheme._getColorHTML(editor_id,"theme_advanced_text_colors","forecolor"))}tinyMCE.switchClass(editor_id+"_forecolor","mceMenuButtonFocus");ml.moveRelativeTo(document.getElementById(editor_id+"_forecolor"),"bl");ml.moveBy(tinyMCE.isMSIE&&!tinyMCE.isOpera?-1:1,-1);if(tinyMCE.isOpera){ml.moveBy(0,-2)}ml.show();return true;case"HiliteColor":var bcp=new TinyMCE_Layer(editor_id+"_bcPreview",false),p,img;TinyMCE_AdvancedTheme._hideMenus(editor_id);if(!bcp.exists()){bcp.create("div","mceColorPreview",document.getElementById(editor_id+"_toolbar"));elm=bcp.getElement();elm._editor_id=editor_id;elm._command="HiliteColor";elm._switchId=editor_id+"_backcolor";tinyMCE.addEvent(elm,"click",TinyMCE_AdvancedTheme._handleMenuEvent);tinyMCE.addEvent(elm,"mouseover",TinyMCE_AdvancedTheme._handleMenuEvent);tinyMCE.addEvent(elm,"mouseout",TinyMCE_AdvancedTheme._handleMenuEvent)}img=tinyMCE.selectNodes(document.getElementById(editor_id+"_backcolor"),function(n){return n.nodeName=="IMG"})[0];p=tinyMCE.getAbsPosition(img,document.getElementById(editor_id+"_toolbar"));bcp.moveTo(p.absLeft,p.absTop);bcp.getElement().style.backgroundColor=value!=null?value:tinyMCE.getInstanceById(editor_id).backColor;bcp.show();return false;case"HiliteColorMenu":TinyMCE_AdvancedTheme._hideMenus(editor_id);var ml=new TinyMCE_Layer(editor_id+"_bcMenu");if(!ml.exists()){ml.create("div","mceMenu",document.body,TinyMCE_AdvancedTheme._getColorHTML(editor_id,"theme_advanced_background_colors","HiliteColor"))}tinyMCE.switchClass(editor_id+"_backcolor","mceMenuButtonFocus");ml.moveRelativeTo(document.getElementById(editor_id+"_backcolor"),"bl");ml.moveBy(tinyMCE.isMSIE&&!tinyMCE.isOpera?-1:1,-1);if(tinyMCE.isOpera){ml.moveBy(0,-2)}ml.show();return true;case"mceColorPicker":if(user_interface){var template=new Array();var inputColor=value.document.getElementById(value.element_id).value;template.file="color_picker.htm";template.width=220;template.height=190;template.close_previous="no";template.width+=tinyMCE.getLang("lang_theme_advanced_colorpicker_delta_width",0);template.height+=tinyMCE.getLang("lang_theme_advanced_colorpicker_delta_height",0);if(typeof(value.store_selection)=="undefined"){value.store_selection=true}tinyMCE.lastColorPickerValue=value;tinyMCE.openWindow(template,{editor_id:editor_id,mce_store_selection:value.store_selection,inline:"yes",command:"mceColorPicker",input_color:inputColor})}else{var savedVal=tinyMCE.lastColorPickerValue;var elm=savedVal.document.getElementById(savedVal.element_id);elm.value=value;if(elm.onchange!=null&&elm.onchange!=""){eval("elm.onchange();")}}return true;case"mceCodeEditor":var template=new Array();template.file="source_editor.htm";template.width=parseInt(tinyMCE.getParam("theme_advanced_source_editor_width",720));template.height=parseInt(tinyMCE.getParam("theme_advanced_source_editor_height",580));tinyMCE.openWindow(template,{editor_id:editor_id,resizable:"yes",scrollbars:"no",inline:"yes"});return true;case"mceCharMap":var template=new Array();template.file="charmap.htm";template.width=550+(tinyMCE.isOpera?40:0);template.height=250;template.width+=tinyMCE.getLang("lang_theme_advanced_charmap_delta_width",0);template.height+=tinyMCE.getLang("lang_theme_advanced_charmap_delta_height",0);tinyMCE.openWindow(template,{editor_id:editor_id,inline:"yes"});return true;case"mceInsertAnchor":var template=new Array();template.file="anchor.htm";template.width=320;template.height=90+(tinyMCE.isNS7?30:0);template.width+=tinyMCE.getLang("lang_theme_advanced_anchor_delta_width",0);template.height+=tinyMCE.getLang("lang_theme_advanced_anchor_delta_height",0);tinyMCE.openWindow(template,{editor_id:editor_id,inline:"yes"});return true;case"mceNewDocument":if(confirm(tinyMCE.getLang("lang_newdocument"))){tinyMCE.execInstanceCommand(editor_id,"mceSetContent",false," ")}return true}return false},getEditorTemplate:function(settings,editorId){function removeFromArray(in_array,remove_array){var outArray=new Array(),skip;for(var i=0;i<in_array.length;i++){skip=false;for(var j=0;j<remove_array.length;j++){if(in_array[i]==remove_array[j]){skip=true}}if(!skip){outArray[outArray.length]=in_array[i]}}return outArray}function addToArray(in_array,add_array){for(var i=0;i<add_array.length;i++){in_array[in_array.length]=add_array[i]}return in_array}var template=new Array();var deltaHeight=0;var resizing=tinyMCE.getParam("theme_advanced_resizing",false);var path=tinyMCE.getParam("theme_advanced_path",true);var statusbarHTML='<div id="{$editor_id}_path" class="mceStatusbarPathText" style="display: '+(path?"block":"none")+'">&#160;</div><div id="{$editor_id}_resize" class="mceStatusbarResize" style="display: '+(resizing?"block":"none")+'" onmousedown="tinyMCE.themes.advanced._setResizing(event,\'{$editor_id}\',true);"></div><br style="clear: both" />';var layoutManager=tinyMCE.getParam("theme_advanced_layout_manager","SimpleLayout");var styleSelectHTML='<option value="">{$lang_theme_style_select}</option>';if(settings.theme_advanced_styles){var stylesAr=settings.theme_advanced_styles.split(";");for(var i=0;i<stylesAr.length;i++){var key,value;key=stylesAr[i].split("=")[0];value=stylesAr[i].split("=")[1];if(value.indexOf(".")!=0){styleSelectHTML+='<option value="&lt;'+value+'&gt;">'+key+"</option>"}else{styleSelectHTML+='<option value="'+value+'">'+key+"</option>"}}TinyMCE_AdvancedTheme._autoImportCSSClasses=false}switch(layoutManager){case"SimpleLayout":var toolbarHTML="";var toolbarLocation=tinyMCE.getParam("theme_advanced_toolbar_location","bottom");var toolbarAlign=tinyMCE.getParam("theme_advanced_toolbar_align","center");var pathLocation=tinyMCE.getParam("theme_advanced_path_location","none");var statusbarLocation=tinyMCE.getParam("theme_advanced_statusbar_location",pathLocation);var defVals={theme_advanced_buttons1:"bold,italic,underline,strikethrough,separator,justifyleft,justifycenter,justifyright,justifyfull,separator,styleselect,formatselect",theme_advanced_buttons2:"bullist,numlist,separator,outdent,indent,separator,undo,redo,separator,link,unlink,anchor,image,cleanup,help,code",theme_advanced_buttons3:"hr,removeformat,visualaid,separator,sub,sup,separator,charmap"};toolbarHTML+='<a href="#" accesskey="q" title="'+tinyMCE.getLang("lang_toolbar_focus")+'"';if(!tinyMCE.getParam("accessibility_focus")){toolbarHTML+=" onfocus=\"tinyMCE.getInstanceById('"+editorId+"').getWin().focus();\""}toolbarHTML+="></a>";for(var i=1;i<100;i++){var def=defVals["theme_advanced_buttons"+i];var buttons=tinyMCE.getParam("theme_advanced_buttons"+i,def==null?"":def,true,",");if(buttons.length==0){break}buttons=removeFromArray(buttons,tinyMCE.getParam("theme_advanced_disable","",true,","));buttons=addToArray(buttons,tinyMCE.getParam("theme_advanced_buttons"+i+"_add","",true,","));buttons=addToArray(tinyMCE.getParam("theme_advanced_buttons"+i+"_add_before","",true,","),buttons);for(var b=0;b<buttons.length;b++){toolbarHTML+=tinyMCE.getControlHTML(buttons[b])}if(buttons.length>0){toolbarHTML+="<br />";deltaHeight-=23}}toolbarHTML+='<a href="#" accesskey="z" onfocus="tinyMCE.getInstanceById(\''+editorId+"').getWin().focus();\"></a>";template.html='<table class="mceEditor" border="0" cellpadding="0" cellspacing="0" width="{$width}" height="{$height}" style="width:{$width_style};height:{$height_style}"><tbody>';if(toolbarLocation=="top"){template.html+='<tr><td class="mceToolbarTop" align="'+toolbarAlign+'" height="1" nowrap="nowrap"><span id="'+editorId+'_toolbar" class="mceToolbarContainer">'+toolbarHTML+"</span></td></tr>"}if(statusbarLocation=="top"){template.html+='<tr><td class="mceStatusbarTop" height="1">'+statusbarHTML+"</td></tr>";deltaHeight-=23}template.html+='<tr><td align="center"><span id="{$editor_id}"></span></td></tr>';if(toolbarLocation=="bottom"){template.html+='<tr><td class="mceToolbarBottom" align="'+toolbarAlign+'" height="1"><span id="'+editorId+'_toolbar" class="mceToolbarContainer">'+toolbarHTML+"</span></td></tr>"}if(toolbarLocation=="external"){var bod=document.body;var elm=document.createElement("div");toolbarHTML=tinyMCE.replaceVar(toolbarHTML,"style_select_options",styleSelectHTML);toolbarHTML=tinyMCE.applyTemplate(toolbarHTML,{editor_id:editorId});elm.className="mceToolbarExternal";elm.id=editorId+"_toolbar";elm.innerHTML='<table border="0"><tr><td><nobr>'+toolbarHTML+"</nobr></td></tr></table>";document.getElementById(tinyMCE.getParam("umbraco_toolbar_id","*")).appendChild(elm);deltaHeight=0;tinyMCE.getInstanceById(editorId).toolbarElement=elm}else{tinyMCE.getInstanceById(editorId).toolbarElement=null}if(statusbarLocation=="bottom"){template.html+='<tr><td class="mceStatusbarBottom" height="1">'+statusbarHTML+"</td></tr>";deltaHeight-=23}template.html+="</tbody></table>";break;case"RowLayout":template.html='<table class="mceEditor" border="0" cellpadding="0" cellspacing="0" width="{$width}" height="{$height}" style="width:{$width}px;height:{$height}px"><tbody>';var containers=tinyMCE.getParam("theme_advanced_containers","",true,",");var defaultContainerCSS=tinyMCE.getParam("theme_advanced_containers_default_class","container");var defaultContainerAlign=tinyMCE.getParam("theme_advanced_containers_default_align","center");for(var i=0;i<containers.length;i++){if(containers[i]=="mceEditor"){template.html+='<tr><td align="center" class="mceEditor_border"><span id="{$editor_id}"></span></td></tr>'}else{if(containers[i]=="mceElementpath"||containers[i]=="mceStatusbar"){var pathClass="mceStatusbar";if(i==containers.length-1){pathClass="mceStatusbarBottom"}else{if(i==0){pathClass="mceStatusbar"}else{deltaHeight-=2}}template.html+='<tr><td class="'+pathClass+'" height="1">'+statusbarHTML+"</td></tr>";deltaHeight-=22}else{var curContainer=tinyMCE.getParam("theme_advanced_container_"+containers[i],"",true,",");var curContainerHTML="";var curAlign=tinyMCE.getParam("theme_advanced_container_"+containers[i]+"_align",defaultContainerAlign);var curCSS=tinyMCE.getParam("theme_advanced_container_"+containers[i]+"_class",defaultContainerCSS);curContainer=removeFromArray(curContainer,tinyMCE.getParam("theme_advanced_disable","",true,","));for(var j=0;j<curContainer.length;j++){curContainerHTML+=tinyMCE.getControlHTML(curContainer[j])}if(curContainer.length>0){curContainerHTML+="<br />";deltaHeight-=23}template.html+='<tr><td class="'+curCSS+'" align="'+curAlign+'" height="1">'+curContainerHTML+"</td></tr>"}}}template.html+="</tbody></table>";break;case"CustomLayout":var customLayout=tinyMCE.getParam("theme_advanced_custom_layout","");if(customLayout!=""&&eval("typeof("+customLayout+")")!="undefined"){template=eval(customLayout+"(template);")}break}if(resizing){template.html+='<span id="{$editor_id}_resize_box" class="mceResizeBox"></span>'}template.html=tinyMCE.replaceVar(template.html,"style_select_options",styleSelectHTML);if(!template.delta_width){template.delta_width=0}if(!template.delta_height){template.delta_height=deltaHeight}return template},initInstance:function(C){if(tinyMCE.getParam("theme_advanced_resizing",false)){if(tinyMCE.getParam("theme_advanced_resizing_use_cookie",true)){var A=TinyMCE_AdvancedTheme._getCookie("TinyMCE_"+C.editorId+"_width");var B=TinyMCE_AdvancedTheme._getCookie("TinyMCE_"+C.editorId+"_height");TinyMCE_AdvancedTheme._resizeTo(C,A,B,tinyMCE.getParam("theme_advanced_resize_horizontal",true))}}C.addShortcut("ctrl","k","lang_link_desc","mceLink")},removeInstance:function(A){var B=new TinyMCE_Layer(A.editorId+"_fcMenu");B.remove()},_handleMenuEvent:function(A){var B=tinyMCE.isMSIE?window.event.srcElement:A.target;tinyMCE._menuButtonEvent(A.type=="mouseover"?"over":"out",document.getElementById(B._switchId));if(A.type=="click"){tinyMCE.execInstanceCommand(B._editor_id,B._command)}},_hideMenus:function(C){var A=new TinyMCE_Layer(C+"_fcMenu"),B=new TinyMCE_Layer(C+"_bcMenu");if(A.exists()&&A.isVisible()){tinyMCE.switchClass(C+"_forecolor","mceMenuButton");A.hide()}if(B.exists()&&B.isVisible()){tinyMCE.switchClass(C+"_backcolor","mceMenuButton");B.hide()}},handleNodeChange:function(C,X,l,d,R,B,N){var V,m,I;function W(n,r,o){o=typeof(o)=="undefined"?false:true;if(n){for(var q=0;q<n.options.length;q++){var p=""+n.options[q].value;if(o&&p.toLowerCase().indexOf(r.toLowerCase())==0){n.selectedIndex=q;return true}if(p==r){n.selectedIndex=q;return true}}}return false}if(X==null){return}var g=document.getElementById(C+"_path");var Z=tinyMCE.getInstanceById(C);var F=Z.getDoc();TinyMCE_AdvancedTheme._hideMenus(C);if(g){var J=X;var b=new Array();while(J!=null){if(J.nodeName.toUpperCase()=="BODY"){break}if(J.nodeType==1&&tinyMCE.getAttrib(J,"class").indexOf("mceItemHidden")==-1){b[b.length]=J}J=J.parentNode}var U="";for(var e=b.length-1;e>=0;e--){var A=b[e].nodeName.toLowerCase();var a="";if(A.indexOf("html:")==0){A=A.substring(5)}if(A=="b"){A="strong"}if(A=="i"){A="em"}if(A=="span"){var S=tinyMCE.getAttrib(b[e],"class");if(S!=""&&S.indexOf("mceItem")==-1){a+="class: "+S+" "}var K=tinyMCE.getAttrib(b[e],"style");if(K!=""){K=tinyMCE.serializeStyle(tinyMCE.parseStyle(K));a+="style: "+tinyMCE.xmlEncode(K)+" "}}if(A=="font"){if(tinyMCE.getParam("convert_fonts_to_spans")){A="span"}var L=tinyMCE.getAttrib(b[e],"face");if(L!=""){a+="font: "+tinyMCE.xmlEncode(L)+" "}var H=tinyMCE.getAttrib(b[e],"size");if(H!=""){a+="size: "+tinyMCE.xmlEncode(H)+" "}var T=tinyMCE.getAttrib(b[e],"color");if(T!=""){a+="color: "+tinyMCE.xmlEncode(T)+" "}}if(tinyMCE.getAttrib(b[e],"id")!=""){a+="id: "+b[e].getAttribute("id")+" "}var f=tinyMCE.getVisualAidClass(tinyMCE.getAttrib(b[e],"class"),false);if(f!=""&&f.indexOf("mceItem")==-1){a+="class: "+f+" "}if(tinyMCE.getAttrib(b[e],"src")!=""){var O=tinyMCE.getAttrib(b[e],"mce_src");if(O==""){O=tinyMCE.getAttrib(b[e],"src")}a+="src: "+tinyMCE.xmlEncode(O)+" "}if(b[e].nodeName=="A"&&tinyMCE.getAttrib(b[e],"href")!=""){var Q=tinyMCE.getAttrib(b[e],"mce_href");if(Q==""){Q=tinyMCE.getAttrib(b[e],"href")}a+="href: "+tinyMCE.xmlEncode(Q)+" "}f=tinyMCE.getAttrib(b[e],"class");if((A=="img"||A=="span")&&f.indexOf("mceItem")!=-1){A=f.replace(/mceItem([a-z]+)/gi,"$1").toLowerCase();a=b[e].getAttribute("title")}if(A=="a"&&(anchor=tinyMCE.getAttrib(b[e],"name"))!=""){A="a";A+="#"+tinyMCE.xmlEncode(anchor);a=""}if(tinyMCE.getAttrib(b[e],"name").indexOf("mce_")!=0){var f=tinyMCE.getVisualAidClass(tinyMCE.getAttrib(b[e],"class"),false);if(f!=""&&f.indexOf("mceItem")==-1){A+="."+f}}var j="tinyMCE.execInstanceCommand('"+C+"','mceSelectNodeDepth',false,'"+e+"');";U+='<a title="'+a+'" href="javascript:'+j+'" onclick="'+j+'return false;" onmousedown="return false;" target="_self" class="mcePathItem">'+A+"</a>";if(e>0){U+=" &raquo; "}}g.innerHTML='<a href="#" accesskey="x"></a>'+tinyMCE.getLang("lang_theme_path")+": "+U+"&#160;"}tinyMCE.switchClass(C+"_justifyleft","mceButtonNormal");tinyMCE.switchClass(C+"_justifyright","mceButtonNormal");tinyMCE.switchClass(C+"_justifycenter","mceButtonNormal");tinyMCE.switchClass(C+"_justifyfull","mceButtonNormal");tinyMCE.switchClass(C+"_bold","mceButtonNormal");tinyMCE.switchClass(C+"_italic","mceButtonNormal");tinyMCE.switchClass(C+"_underline","mceButtonNormal");tinyMCE.switchClass(C+"_strikethrough","mceButtonNormal");tinyMCE.switchClass(C+"_bullist","mceButtonNormal");tinyMCE.switchClass(C+"_numlist","mceButtonNormal");tinyMCE.switchClass(C+"_sub","mceButtonNormal");tinyMCE.switchClass(C+"_sup","mceButtonNormal");tinyMCE.switchClass(C+"_anchor","mceButtonNormal");tinyMCE.switchClass(C+"_link","mceButtonDisabled");tinyMCE.switchClass(C+"_unlink","mceButtonDisabled");tinyMCE.switchClass(C+"_outdent","mceButtonDisabled");tinyMCE.switchClass(C+"_image","mceButtonNormal");tinyMCE.switchClass(C+"_hr","mceButtonNormal");if(X.nodeName=="A"&&tinyMCE.getAttrib(X,"class").indexOf("mceItemAnchor")!=-1){tinyMCE.switchClass(C+"_anchor","mceButtonSelected")}var D=tinyMCE.getParentElement(X,"a","href");if(D||B){tinyMCE.switchClass(C+"_link",D?"mceButtonSelected":"mceButtonNormal");tinyMCE.switchClass(C+"_unlink",D?"mceButtonSelected":"mceButtonNormal")}tinyMCE.switchClass(C+"_visualaid",R?"mceButtonSelected":"mceButtonNormal");if(d!=-1){tinyMCE.switchClass(C+"_undo","mceButtonDisabled");tinyMCE.switchClass(C+"_redo","mceButtonDisabled")}if(tinyMCE.getParentElement(X,"li,blockquote")){tinyMCE.switchClass(C+"_outdent","mceButtonNormal")}if(l!=-1&&(l<d-1&&d>0)){tinyMCE.switchClass(C+"_redo","mceButtonNormal")}if(l!=-1&&(l>0&&d>0)){tinyMCE.switchClass(C+"_undo","mceButtonNormal")}var P=document.getElementById(C+"_umbracoFormatSelect");if(P){TinyMCE_AdvancedTheme._setupCSSClasses(C);I=X;m=false;var Y=0;do{if(I&&I.className){for(var e=0;e<P.options.length;e++){if(P.options[e].value=="."+I.className){Y=e;m=true;break}}}}while(!m&&I!=null&&(I=I.parentNode)!=null);P.selectedIndex=Y}var P=document.getElementById(C+"_umbracoFormatSelect");if(P){var k=tinyMCE.getParentElement(X,"p,div,h1,h2,h3,h4,h5,h6,pre,address");if(k){W(P,"<"+k.nodeName.toLowerCase()+">")}else{W(P,"")}}var P=document.getElementById(C+"_fontNameSelect");if(P){if(!tinyMCE.isSafari&&!(tinyMCE.isMSIE&&!tinyMCE.isOpera)){var L=Z.queryCommandValue("FontName");L=L==null||L==""?"":L;W(P,L,L!="")}else{var k=tinyMCE.getParentElement(X,"font","face");if(k){var G=tinyMCE.getAttrib(k,"face");if(G==""){G=""+k.style.fontFamily}if(!W(P,G,G!="")){W(P,"")}}else{W(P,"")}}}var P=document.getElementById(C+"_fontSizeSelect");if(P){if(!tinyMCE.isSafari&&!tinyMCE.isOpera){var H=Z.queryCommandValue("FontSize");W(P,H==null||H==""?"0":H)}else{var k=tinyMCE.getParentElement(X,"font","size");if(k){var H=tinyMCE.getAttrib(k,"size");if(H==""){var M=new Array("","8px","10px","12px","14px","18px","24px","36px");H=""+k.style.fontSize;for(var e=0;e<M.length;e++){if((""+M[e])==H){H=e;break}}}if(!W(P,H)){W(P,"")}}else{W(P,"0")}}}V=X;m=false;do{if(!V.getAttribute||!V.getAttribute("align")){continue}switch(V.getAttribute("align").toLowerCase()){case"left":tinyMCE.switchClass(C+"_justifyleft","mceButtonSelected");m=true;break;case"right":tinyMCE.switchClass(C+"_justifyright","mceButtonSelected");m=true;break;case"middle":case"center":tinyMCE.switchClass(C+"_justifycenter","mceButtonSelected");m=true;break;case"justify":tinyMCE.switchClass(C+"_justifyfull","mceButtonSelected");m=true;break}}while(!m&&(V=V.parentNode)!=null);var h=tinyMCE.getParentElement(X,"div");if(h&&h.style.textAlign=="center"){tinyMCE.switchClass(C+"_justifycenter","mceButtonSelected")}if(!N){var E=new Array("Bold","_bold","Italic","_italic","Strikethrough","_strikethrough","superscript","_sup","subscript","_sub");for(var e=0;e<E.length;e+=2){if(Z.queryCommandState(E[e])){tinyMCE.switchClass(C+E[e+1],"mceButtonSelected")}}if(Z.queryCommandState("Underline")&&(X.parentNode==null||X.parentNode.nodeName!="A")){tinyMCE.switchClass(C+"_underline","mceButtonSelected")}}do{switch(X.nodeName){case"UL":tinyMCE.switchClass(C+"_bullist","mceButtonSelected");break;case"OL":tinyMCE.switchClass(C+"_numlist","mceButtonSelected");break;case"HR":tinyMCE.switchClass(C+"_hr","mceButtonSelected");break;case"IMG":if(tinyMCE.getAttrib(X,"name").indexOf("mce_")!=0&&tinyMCE.getAttrib(X,"class").indexOf("mceItem")==-1){tinyMCE.switchClass(C+"_image","mceButtonSelected")}break}}while((X=X.parentNode)!=null)},_setupCSSClasses:function(D){var B,A;if(!TinyMCE_AdvancedTheme._autoImportCSSClasses){return}A=document.getElementById(D+"_styleSelect");if(A&&A.getAttribute("cssImported")!="true"){var C=tinyMCE.getCSSClasses(D);if(C&&A){for(B=0;B<C.length;B++){A.options[A.options.length]=new Option(C[B],C[B])}}if(C!=null&&C.length>0){A.setAttribute("cssImported","true")}}},_setCookie:function(C,E,A,G,D,F){var B=C+"="+escape(E)+((A)?"; expires="+A.toGMTString():"")+((G)?"; path="+escape(G):"")+((D)?"; domain="+D:"")+((F)?"; secure":"");document.cookie=B},_getCookie:function(C){var B=document.cookie;var E=C+"=";var D=B.indexOf("; "+E);if(D==-1){D=B.indexOf(E);if(D!=0){return null}}else{D+=2}var A=document.cookie.indexOf(";",D);if(A==-1){A=B.length}return unescape(B.substring(D+E.length,A))},_resizeTo:function(D,I,F,G){var E=document.getElementById(D.editorId+"_parent");var H=E.firstChild;var C=D.iframeElement;if(I==null||I=="null"){G=false;I=0}if(F==null||F=="null"){return}I=parseInt(I);F=parseInt(F);if(tinyMCE.isGecko){I+=2;F+=2}var K=I-H.clientWidth;var J=F-H.clientHeight;I=I<1?30:I;F=F<1?30:F;if(G){H.style.width=I+"px"}H.style.height=F+"px";iw=C.clientWidth+K;ih=C.clientHeight+J;iw=iw<1?30:iw;ih=ih<1?30:ih;if(tinyMCE.isGecko){iw-=2;ih-=2}if(G){C.style.width=iw+"px"}C.style.height=ih+"px";if(G){var B=H.firstChild;var A=B.scrollWidth;if(D.iframeElement.clientWidth<A){K=A-D.iframeElement.clientWidth;D.iframeElement.style.width=(iw+K)+"px"}}D.useCSS=false},_resizeEventHandler:function(E){var G=TinyMCE_AdvancedTheme._resizer;if(!G.resizing){return}E=typeof(E)=="undefined"?window.event:E;var I=E.screenX-G.downX;var H=E.screenY-G.downY;var B=G.resizeBox;var C=G.editorId;switch(E.type){case"mousemove":var F,D;F=G.width+I;D=G.height+H;F=F<1?1:F;D=D<1?1:D;if(G.horizontal){B.style.width=F+"px"}B.style.height=D+"px";break;case"mouseup":TinyMCE_AdvancedTheme._setResizing(E,C,false);TinyMCE_AdvancedTheme._resizeTo(tinyMCE.getInstanceById(C),G.width+I,G.height+H,G.horizontal);if(tinyMCE.getParam("theme_advanced_resizing_use_cookie",true)){var A=new Date();A.setTime(A.getTime()+3600000*24*30);TinyMCE_AdvancedTheme._setCookie("TinyMCE_"+C+"_width",""+(G.horizontal?G.width+I:""),A);TinyMCE_AdvancedTheme._setCookie("TinyMCE_"+C+"_height",""+(G.height+H),A)}break}},_setResizing:function(G,H,A){G=typeof(G)=="undefined"?window.event:G;var I=TinyMCE_AdvancedTheme._resizer;var E=document.getElementById(H+"_parent");var F=document.getElementById(H+"_parent").firstChild;var C=document.getElementById(H+"_resize_box");var D=tinyMCE.getInstanceById(H);if(A){var B=F.clientWidth;var J=F.clientHeight;C.style.width=B+"px";C.style.height=J+"px";I.iframeWidth=D.iframeElement.clientWidth;I.iframeHeight=D.iframeElement.clientHeight;F.style.display="none";C.style.display="block";if(!I.eventHandlers){if(tinyMCE.isMSIE){tinyMCE.addEvent(document,"mousemove",TinyMCE_AdvancedTheme._resizeEventHandler)}else{tinyMCE.addEvent(window,"mousemove",TinyMCE_AdvancedTheme._resizeEventHandler)}tinyMCE.addEvent(document,"mouseup",TinyMCE_AdvancedTheme._resizeEventHandler);I.eventHandlers=true}I.resizing=true;I.downX=G.screenX;I.downY=G.screenY;I.width=parseInt(C.style.width);I.height=parseInt(C.style.height);I.editorId=H;I.resizeBox=C;I.horizontal=tinyMCE.getParam("theme_advanced_resize_horizontal",true)}else{I.resizing=false;C.style.display="none";F.style.display=tinyMCE.isMSIE&&!tinyMCE.isOpera?"block":"table";tinyMCE.execCommand("mceResetDesignMode")}},_getColorHTML:function(F,E,A){var C,D,B;D='<span class="mceMenuLine"></span>';B=tinyMCE.getParam(E,TinyMCE_AdvancedTheme._defColors).split(",");D+='<table class="mceColors"><tr>';for(C=0;C<B.length;C++){c="tinyMCE.execInstanceCommand('"+F+"', '"+A+"', false, '#"+B[C]+"');";D+='<td><a href="javascript:'+c+'" style="background-color: #'+B[C]+'" onclick="'+c+';return false;"></a></td>';if((C+1)%8==0){D+="</tr><tr>"}}D+="</tr></table>";return D},_insertImage:function(src,alt,border,hspace,vspace,width,height,align,title,onmouseover,onmouseout){tinyMCE.execCommand("mceBeginUndoLevel");if(src==""){return}if(!tinyMCE.imgElement&&tinyMCE.isSafari){var html="";html+='<img src="'+src+'" alt="'+alt+'"';html+=' border="'+border+'" hspace="'+hspace+'"';html+=' vspace="'+vspace+'" width="'+width+'"';html+=' height="'+height+'" align="'+align+'" title="'+title+'" onmouseover="'+onmouseover+'" onmouseout="'+onmouseout+'" />';tinyMCE.execCommand("mceInsertContent",false,html)}else{if(!tinyMCE.imgElement&&tinyMCE.selectedInstance){if(tinyMCE.isSafari){tinyMCE.execCommand("mceInsertContent",false,'<img src="'+tinyMCE.uniqueURL+'" />')}else{tinyMCE.selectedInstance.contentDocument.execCommand("insertimage",false,tinyMCE.uniqueURL)}tinyMCE.imgElement=tinyMCE.getElementByAttributeValue(tinyMCE.selectedInstance.contentDocument.body,"img","src",tinyMCE.uniqueURL)}}if(tinyMCE.imgElement){var needsRepaint=false;var msrc=src;src=eval(tinyMCE.settings.urlconverter_callback+"(src, tinyMCE.imgElement);");if(tinyMCE.getParam("convert_urls")){msrc=src}if(onmouseover&&onmouseover!=""){onmouseover="this.src='"+eval(tinyMCE.settings.urlconverter_callback+"(onmouseover, tinyMCE.imgElement);")+"';"}if(onmouseout&&onmouseout!=""){onmouseout="this.src='"+eval(tinyMCE.settings.urlconverter_callback+"(onmouseout, tinyMCE.imgElement);")+"';"}if(typeof(title)=="undefined"){title=alt}if(width!=tinyMCE.imgElement.getAttribute("width")||height!=tinyMCE.imgElement.getAttribute("height")||align!=tinyMCE.imgElement.getAttribute("align")){needsRepaint=true}tinyMCE.setAttrib(tinyMCE.imgElement,"src",src);tinyMCE.setAttrib(tinyMCE.imgElement,"mce_src",msrc);tinyMCE.setAttrib(tinyMCE.imgElement,"alt",alt);tinyMCE.setAttrib(tinyMCE.imgElement,"title",title);tinyMCE.setAttrib(tinyMCE.imgElement,"align",align);tinyMCE.setAttrib(tinyMCE.imgElement,"border",border,true);tinyMCE.setAttrib(tinyMCE.imgElement,"hspace",hspace,true);tinyMCE.setAttrib(tinyMCE.imgElement,"vspace",vspace,true);tinyMCE.setAttrib(tinyMCE.imgElement,"width",width,true);tinyMCE.setAttrib(tinyMCE.imgElement,"height",height,true);tinyMCE.setAttrib(tinyMCE.imgElement,"onmouseover",onmouseover);tinyMCE.setAttrib(tinyMCE.imgElement,"onmouseout",onmouseout);if(width&&width!=""){tinyMCE.imgElement.style.pixelWidth=width}if(height&&height!=""){tinyMCE.imgElement.style.pixelHeight=height}if(needsRepaint){tinyMCE.selectedInstance.repaint()}}tinyMCE.execCommand("mceEndUndoLevel")},_insertLink:function(href,target,title,onclick,style_class){tinyMCE.execCommand("mceBeginUndoLevel");if(tinyMCE.selectedInstance&&tinyMCE.selectedElement&&tinyMCE.selectedElement.nodeName.toLowerCase()=="img"){var doc=tinyMCE.selectedInstance.getDoc();var linkElement=tinyMCE.getParentElement(tinyMCE.selectedElement,"a");var newLink=false;if(!linkElement){linkElement=doc.createElement("a");newLink=true}var mhref=href;var thref=eval(tinyMCE.settings.urlconverter_callback+"(href, linkElement);");mhref=tinyMCE.getParam("convert_urls")?href:mhref;tinyMCE.setAttrib(linkElement,"href",thref);tinyMCE.setAttrib(linkElement,"mce_href",mhref);tinyMCE.setAttrib(linkElement,"target",target);tinyMCE.setAttrib(linkElement,"title",title);tinyMCE.setAttrib(linkElement,"onclick",onclick);tinyMCE.setAttrib(linkElement,"class",style_class);if(newLink){linkElement.appendChild(tinyMCE.selectedElement.cloneNode(true));tinyMCE.selectedElement.parentNode.replaceChild(linkElement,tinyMCE.selectedElement)}return}if(!tinyMCE.linkElement&&tinyMCE.selectedInstance){if(tinyMCE.isSafari){tinyMCE.execCommand("mceInsertContent",false,'<a href="'+tinyMCE.uniqueURL+'">'+tinyMCE.selectedInstance.selection.getSelectedHTML()+"</a>")}else{tinyMCE.selectedInstance.contentDocument.execCommand("createlink",false,tinyMCE.uniqueURL)}tinyMCE.linkElement=tinyMCE.getElementByAttributeValue(tinyMCE.selectedInstance.contentDocument.body,"a","href",tinyMCE.uniqueURL);var elementArray=tinyMCE.getElementsByAttributeValue(tinyMCE.selectedInstance.contentDocument.body,"a","href",tinyMCE.uniqueURL);for(var i=0;i<elementArray.length;i++){var mhref=href;var thref=eval(tinyMCE.settings.urlconverter_callback+"(href, elementArray[i]);");mhref=tinyMCE.getParam("convert_urls")?href:mhref;tinyMCE.setAttrib(elementArray[i],"href",thref);tinyMCE.setAttrib(elementArray[i],"mce_href",mhref);tinyMCE.setAttrib(elementArray[i],"target",target);tinyMCE.setAttrib(elementArray[i],"title",title);tinyMCE.setAttrib(elementArray[i],"onclick",onclick);tinyMCE.setAttrib(elementArray[i],"class",style_class)}tinyMCE.linkElement=elementArray[0]}if(tinyMCE.linkElement){var mhref=href;href=eval(tinyMCE.settings.urlconverter_callback+"(href, tinyMCE.linkElement);");mhref=tinyMCE.getParam("convert_urls")?href:mhref;tinyMCE.setAttrib(tinyMCE.linkElement,"href",href);tinyMCE.setAttrib(tinyMCE.linkElement,"mce_href",mhref);tinyMCE.setAttrib(tinyMCE.linkElement,"target",target);tinyMCE.setAttrib(tinyMCE.linkElement,"title",title);tinyMCE.setAttrib(tinyMCE.linkElement,"onclick",onclick);tinyMCE.setAttrib(tinyMCE.linkElement,"class",style_class)}tinyMCE.execCommand("mceEndUndoLevel")}};tinyMCE.addTheme("advanced",TinyMCE_AdvancedTheme);tinyMCE.addButtonMap(TinyMCE_AdvancedTheme._buttonMap);