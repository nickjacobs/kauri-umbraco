tinyMCE.importPluginLanguagePack("preview");var TinyMCE_PreviewPlugin={getInfo:function(){return{longname:"Preview",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://tinymce.moxiecode.com/tinymce/docs/plugin_preview.html",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}},getControlHTML:function(A){switch(A){case"preview":return tinyMCE.getButtonHTML(A,"lang_preview_desc","{$pluginurl}/images/preview.gif","mcePreview")}return""},execCommand:function(N,E,C,A,O){switch(C){case"mcePreview":var J=tinyMCE.getParam("plugin_preview_pageurl",null);var B=tinyMCE.getParam("plugin_preview_width","550");var I=tinyMCE.getParam("plugin_preview_height","600");if(J){var P=new Array();P.file=J;P.width=B;P.height=I;tinyMCE.openWindow(P,{editor_id:N,resizable:"yes",scrollbars:"yes",inline:"yes",content:tinyMCE.getContent(),content_css:tinyMCE.getParam("content_css")})}else{var H=window.open("","mcePreview","menubar=no,toolbar=no,scrollbars=yes,resizable=yes,left=20,top=20,width="+B+",height="+I);var F="",D;var K=tinyMCE.getContent();var M=K.indexOf("<body"),L,G=tinyMCE.getParam("content_css").split(",");if(M!=-1){M=K.indexOf(">",M);L=K.lastIndexOf("</body>");K=K.substring(M+1,L)}F+=tinyMCE.getParam("doctype");F+='<html xmlns="http://www.w3.org/1999/xhtml">';F+="<head>";F+="<title>"+tinyMCE.getLang("lang_preview_desc")+"</title>";F+='<base href="'+tinyMCE.settings.base_href+'" />';F+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';for(D=0;D<G.length;D++){F+='<link href="'+G[D]+'" rel="stylesheet" type="text/css" />'}F+='<script type="text/javascript">';F+="window.opener.TinyMCE_PreviewPlugin._setDoc(document);";F+="window.opener.TinyMCE_PreviewPlugin._setWin(window);";F+="writeFlash = window.opener.TinyMCE_PreviewPlugin._writeFlash;";F+="writeShockWave = window.opener.TinyMCE_PreviewPlugin._writeShockWave;";F+="writeQuickTime = window.opener.TinyMCE_PreviewPlugin._writeQuickTime;";F+="writeRealMedia = window.opener.TinyMCE_PreviewPlugin._writeRealMedia;";F+="writeWindowsMedia = window.opener.TinyMCE_PreviewPlugin._writeWindowsMedia;";F+="writeEmbed = window.opener.TinyMCE_PreviewPlugin._writeEmbed;";F+="<\/script>";F+="</head>";F+='<body dir="'+tinyMCE.getParam("directionality")+'" onload="window.opener.TinyMCE_PreviewPlugin._onLoad();">';F+=K;F+="</body>";F+="</html>";H.document.write(F);H.document.close()}return true}return false},_setDoc:function(A){TinyMCE_PreviewPlugin._doc=A;A._embeds=new Array()},_setWin:function(A){TinyMCE_PreviewPlugin._win=A},_onLoad:function(){var B,C,D=new Array(),F=TinyMCE_PreviewPlugin._doc,A,E;B=F.getElementsByTagName("script");for(C=0;C<B.length;C++){A=tinyMCE.isMSIE?B[C].innerHTML:B[C].firstChild.nodeValue;if(new RegExp("write(Flash|ShockWave|WindowsMedia|QuickTime|RealMedia)\\(.*","g").test(A)){D[D.length]=B[C]}}for(C=0;C<D.length;C++){E=F.createElement("div");E.innerHTML=F._embeds[C];D[C].parentNode.insertBefore(E.firstChild,D[C])}},_writeFlash:function(A){A.src=tinyMCE.convertRelativeToAbsoluteURL(tinyMCE.settings.base_href,A.src);TinyMCE_PreviewPlugin._writeEmbed("D27CDB6E-AE6D-11cf-96B8-444553540000","http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0","application/x-shockwave-flash",A)},_writeShockWave:function(A){A.src=tinyMCE.convertRelativeToAbsoluteURL(tinyMCE.settings.base_href,A.src);TinyMCE_PreviewPlugin._writeEmbed("166B1BCA-3F9C-11CF-8075-444553540000","http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0","application/x-director",A)},_writeQuickTime:function(A){A.src=tinyMCE.convertRelativeToAbsoluteURL(tinyMCE.settings.base_href,A.src);TinyMCE_PreviewPlugin._writeEmbed("02BF25D5-8C17-4B23-BC80-D3488ABDDC6B","http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0","video/quicktime",A)},_writeRealMedia:function(A){A.src=tinyMCE.convertRelativeToAbsoluteURL(tinyMCE.settings.base_href,A.src);TinyMCE_PreviewPlugin._writeEmbed("CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA","http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0","audio/x-pn-realaudio-plugin",A)},_writeWindowsMedia:function(A){A.src=tinyMCE.convertRelativeToAbsoluteURL(tinyMCE.settings.base_href,A.src);A.url=A.src;TinyMCE_PreviewPlugin._writeEmbed("6BF52A52-394A-11D3-B153-00C04F79FAA6","http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701","application/x-mplayer2",A)},_writeEmbed:function(I,D,A,B){var F="",C,G=TinyMCE_PreviewPlugin._doc,E,H;F+='<object classid="clsid:'+I+'" codebase="'+D+'"';F+=typeof(B.id)!="undefined"?'id="'+B.id+'"':"";F+=typeof(B.name)!="undefined"?'name="'+B.name+'"':"";F+=typeof(B.width)!="undefined"?'width="'+B.width+'"':"";F+=typeof(B.height)!="undefined"?'height="'+B.height+'"':"";F+=typeof(B.align)!="undefined"?'align="'+B.align+'"':"";F+=">";for(C in B){F+='<param name="'+C+'" value="'+B[C]+'">'}F+='<embed type="'+A+'"';for(C in B){F+=C+'="'+B[C]+'" '}F+="></embed></object>";G._embeds[G._embeds.length]=F}};tinyMCE.addPlugin("preview",TinyMCE_PreviewPlugin);