cssFile="css/officexp.css";Menu.prototype.cssFile=cssFile;var tmp;var menuMethods=new Array(menuItem("C","new.gif","Create","createNew()"),menuItem("D","delete.small.png","Delete","deleteThis()"),menuItem("M","cut.small.png","Move","moveThis()"),menuItem("O","copy.small.png","Copy","copyThis()"),menuItem("S","sort.png","Sort","sortThis()"),menuItem("R","permission.png","Rights","permissionThis()"),menuItem("P","protect.png","Public access","accessThis()"),menuItem("L","refresh.png","Reload","refreshNode()"));var undoItem,cutItem,copyItem,pasteItem,deleteItem,selectAllItem;var oldOpenState=null;var lastKeyCode=0;function rememberKeyCode(){lastKeyCode=window.event.keyCode}function showContextMenu(){var E=new Menu();if(parent.nodeID!="-1"&&parent.nodeType!=""){var C=parent.nodeMenu;for(var B=0;B<C.length;B++){if(C.substring(B,B+1)!=","){thisMethod=findMenuItems(C.substring(B,B+1));if(thisMethod){E.add(temp=new MenuItem(thisMethod.text,thisMethod.method,"images/"+thisMethod.icon));temp.mnemonic=thisMethod.alias}}else{E.add(new MenuSeparator())}}var D=window.event.srcElement;var A=true;var G,F;if(A){D=window.event.srcElement}else{if(!showOpenItems){D=document.documentElement}}if(lastKeyCode==93){G=posLib.getScreenLeft(D);F=posLib.getScreenTop(D)}else{G=window.event.screenX;F=window.event.screenY}if(A){u;E.invalidate();E.show(G,F)}else{cMenu.invalidate();cMenu.show(G,F)}event.returnValue=false;lastKeyCode=0}}function menuItem(A,B,D,E){var C=new menuItemPrototype();C.alias=A;C.icon=B;C.text=D;C.method=E;return C}function menuItemPrototype(){this.alias="";this.icon="";this.text="";this.method=""}function findMenuItems(B){for(var A=0;A<menuMethods.length;A++){if(menuMethods[A].alias==B){return menuMethods[A];break}}}document.attachEvent("oncontextmenu",showContextMenu);document.attachEvent("onkeyup",rememberKeyCode);