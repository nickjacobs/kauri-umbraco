var modalActive=false;var rightWindowTab=false;var rightButtons=false;var nodeID=-1;var nodeKey="";var nodeType="";var nodeName="";var topNodeID=-1;var currentApp="";var nodeDeleteEffectElement=null;var deleteNode;var expandTries=0;var refresh=true;var refreshParent=true;var dontDelete=false;function deleteEffect(){if(deleteNode.parentNode.childNodes.length==1){deleteNode.parentNode.childNodes=[]}deleteNode.collapse();nodeDeleteEffectElement=deleteNode;tree.jQuery("#"+deleteNode.id).hide("drop",{direction:"down"},400);if((currentApp==""||currentApp=="content")&&deleteNode.parentNode.nodeID!=-20){updateRecycleBin()}setTimeout('nodeDeleteEffectElement.remove(); tree.jQuery("#fxWrapper").hide();',1000)}function refreshTree(A,B){expandTries=0;refreshParent=A;dontDelete=B;if(refreshParent){if(node!=null&&refresh){if(node.parentNode!=null){if(dontDelete){node=node.parentNode}else{if(node.parentNode.childNodes.length==1){node.parentNode.childNodes=[]}node.collapse();new tree.Effect.DropOut(node.id);nodeDeleteEffectElement=node;if(node.parentNode.nodeID!=-20){updateRecycleBin()}setTimeout("nodeDeleteEffectElement.remove()",1000)}}}}if(!refreshParent||(refreshParent&&dontDelete)){if(node!=null&&refresh){if(node.parentNode!=null){if(node.src!=""&&node.src!=null){node.src=node.src+"&rnd="+returnRandom();node.reload();setTimeout("expandNode()",200)}else{if(node.srcRoot!=""&&node.srcRoot!=null){node.src=node.srcRoot;node.reload();node.expand();setTimeout("expandNode()",200)}}}else{tree.document.location.href=tree.document.location.href}}else{if(!refresh){tree.document.location.href=tree.document.location.href}}}}function fetchUrl(A){A=A.split("/");if(A.length>0){tmp=A[A.length-1]}else{tmp=A}if(tmp.indexOf("?")>0){tmp=tmp.substring(0,tmp.indexOf("?"))}return tmp}function expandNode(){if(parent.node.childNodes.length==0&&expandTries<10){expandTries++;setTimeout("expandNode()",200)}else{parent.node.expand();expandTries=0}}function reloadParentNode(B){var A=false;if(node!=null){if(node.parentNode){if(node.parentNode.parentNode){A=true}}}if(A){node.parentNode.src=node.parentNode.src+"&rnd2="+returnRandom();node.parentNode.reload();if(B){node.parentNode.expand()}}else{tree.document.location.href=tree.document.location.href}}function reloadCurrentNode(){var A=false;if(node!=null){if(node.parentNode){A=true}}if(A){node.src=node.src+"&rnd2="+returnRandom();node.reload();node.expand()}else{tree.document.location.href=tree.document.location.href}}function returnRandom(){day=new Date();z=day.getTime();y=(z-(parseInt(z/1000,10)*1000))/10;return y}function disableModal(){modalActive=false}var theDialogWindow=null;function openDialog(A,B,D,E,C){modalActive=true;if(theDialogWindow!=null&&!theDialogWindow.closed){theDialogWindow.close()}theDialogWindow=window.open(B,"dialogpage","width="+D+"px,height="+E+"px"+C)}function createNew(){if(nodeType!=""){if(currentApp=="content"||currentApp==""){openModal("create.aspx?nodeID="+nodeID+"&nodeType="+nodeType+"&nodeName="+nodeName+"&rnd="+returnRandom(),uiKeys.actions_create,425,600)}else{if(nodeType=="initmember"){openModal("create.aspx?nodeID="+nodeID+"&nodeType="+nodeType+"&nodeName="+nodeName+"&rnd="+returnRandom(),uiKeys.actions_create,380,420)}else{openModal("create.aspx?nodeID="+nodeID+"&nodeType="+nodeType+"&nodeName="+nodeName+"&rnd="+returnRandom(),uiKeys.actions_create,270,420)}}return false}}function createFolder(){if(nodeType!=""){openDialog("Opret","createFolder.aspx?nodeID="+nodeID+"&nodeType="+nodeType+"&nodeName="+nodeName+"&rnd="+returnRandom(),320,225)}}function importDocumentType(){if(nodeType!=""){openModal("dialogs/importDocumentType.aspx?rnd="+returnRandom(),uiKeys.actions_importDocumentType,460,400);return false}}function exportDocumentType(){if(nodeType!=""){openDialog("Export","dialogs/exportDocumentType.aspx?nodeID="+nodeID+"&rnd="+returnRandom(),320,205)}}function refreshNode(){if(nodeKey!=""){if(tree.webFXTreeHandler.all[nodeKey]){tree.webFXTreeHandler.all[nodeKey].src=tree.webFXTreeHandler.all[nodeKey].src+"&rnd="+Math.random()*10;if(tree.webFXTreeHandler.all[nodeKey].parentNode){if(tree.webFXTreeHandler.all[nodeKey].childNodes.length>0){if(!tree.webFXTreeHandler.all[nodeKey].open){tree.webFXTreeHandler.all[nodeKey].expand()}tree.webFXTreeHandler.all[nodeKey].reload();treeEdited=true}}else{tree.document.location.href=tree.document.location.href}}}}function accessThis(){if(nodeID!="-1"&&nodeType!=""){task.document.dataForm.nodeID.value=nodeID;task.document.dataForm.nodeType.value=nodeType;newName=window.open("dialogs/publicAccess.aspx?nodeID="+nodeID+"&rnd="+returnRandom(),"access","width=530,height=550,scrollbars=auto")}}function assignDomain(){if(nodeID!="-1"&&nodeType!=""){openModal("dialogs/assignDomain.aspx?id="+nodeID,uiKeys.actions_assignDomain,420,500);return false}}function publish(){if(nodeID!="-1"&&nodeType!=""){openModal("dialogs/publish.aspx?id="+nodeID,uiKeys.actions_publish,280,540);return false}}function about(){openModal("dialogs/about.aspx",uiKeys.general_about,390,450);return false}function emptyTrashcan(){if(nodeID!="-1"&&nodeType!=""){openModal("dialogs/emptyTrashcan.aspx",uiKeys.actions_emptyTrashcan,220,500);return false}}function sortThis(){if(nodeID!="0"&&nodeType!=""){openModal("dialogs/sort.aspx?id="+nodeID+"&app="+currentApp+"&rnd="+returnRandom(),uiKeys.actions_sort,450,600);return false}}function protectThis(){if(nodeID!="-1"&&nodeType!=""){openModal("dialogs/protectPage.aspx?app="+currentApp+"&mode=cut&nodeId="+nodeID+"&rnd="+returnRandom(),uiKeys.actions_protect,480,535);return false}}function moveThis(){if(nodeID!="-1"&&nodeType!=""){openModal("dialogs/moveOrCopy.aspx?app="+currentApp+"&mode=cut&id="+nodeID+"&rnd="+returnRandom(),uiKeys.actions_move,460,500);return false}}function rightsThis(){if(nodeID!="-1"&&nodeType!=""){openModal("dialogs/cruds.aspx?id="+nodeID+"&rnd="+returnRandom(),uiKeys.actions_rights,300,800);return false}}function showDashboard(){openModal("dashboard.aspx?app"+currentApp+"&modal=true",currentApp+uiKeys.actions_dashboard,600,800);return false}function changeDashboard(A){right.location.href=A}function notifyThis(){if(nodeID!="-1"&&nodeType!=""){openModal("dialogs/notifications.aspx?id="+nodeID+"&rnd="+returnRandom(),uiKeys.actions_notify,480,300);return false}}function createWizard(){if(currentApp=="media"||currentApp=="content"||currentApp==""){if(currentApp==""){currentApp="content"}openModal("dialogs/create.aspx?nodeType="+currentApp+"&app="+currentApp+"&rnd="+returnRandom(),uiKeys.actions_create+" "+currentApp,470,620);return false}else{alert("Not supported - please create by right clicking the parentnode and choose new...")}}function copyThis(){if(nodeID!="-1"&&nodeType!=""){openModal("dialogs/moveOrCopy.aspx?app="+currentApp+"&mode=copy&id="+nodeID+"&rnd="+returnRandom(),uiKeys.actions_copy,470,500);return false}}function translateThis(){if(nodeID!="-1"&&nodeType!=""){openModal("dialogs/sendToTranslation.aspx?app="+currentApp+"&id="+nodeID+"&rnd="+returnRandom(),uiKeys.actions_sendToTranslate,470,500);return false}}function liveEdit(){window.open("canvas.aspx?redir=/"+nodeID+".aspx","liveediting")}function toPublish(){if(nodeID!="-1"&&nodeType!=""){if(confirm(parent.uiKeys.defaultdialogs_confirmSure+"\n\n")){openModal("dialogs/SendPublish.aspx?id="+nodeID+"&rnd="+returnRandom(),uiKeys.actions_sendtopublish,200,300);return false}}}function deleteThis(){var D=true;if(currentApp=="content"&&nodeID=="-1"){D=false}if(D){var C=nodeID;var B=nodeType;var A=nodeName;if(confirm(parent.uiKeys.defaultdialogs_confirmdelete+' "'+nodeName+'"?\n\n')){deleteNode=node;nodeID=C;nodeType=B;nodeName=A;umbraco.presentation.webservices.legacyAjaxCalls.Delete(C,"",B,refreshDelete)}}}function refreshDelete(){deleteEffect()}function disableThis(){if(confirm(parent.uiKeys.defaultdialogs_confirmdisable+' "'+nodeName+'"?\n\n')){umbraco.presentation.webservices.legacyAjaxCalls.DisableUser(nodeID,refreshDisabled)}}function refreshDisabled(){tree.document.location.href=tree.document.location.href+"&refresh=true"}function republish(){openModal("dialogs/republish.aspx?rnd="+returnRandom(),"Republishing entire site",210,450);return false}function viewAuditTrail(){openModal("dialogs/viewAuditTrail.aspx?nodeID="+nodeID+"&rnd="+returnRandom(),uiKeys.actions_auditTrail,500,550);return false}function rollback(){openModal("dialogs/rollback.aspx?nodeID="+nodeID+"&rnd="+returnRandom(),uiKeys.actions_rollback,550,600);return false}function importPackage(){parent.openDialog("packager","dialogs/packager.aspx?rnd="+parent.returnRandom(),530,550,",scrollbars=yes")}function closeUmbraco(){if(confirm(parent.uiKeys.defaultdialogs_confirmlogout+"\n\n")){document.location.href="logout.aspx"}}function shiftApp(C,A,B){currentApp=C.toLowerCase();if(currentApp!="media"&&currentApp!="content"){document.getElementById("buttonCreate").disabled=true}else{document.getElementById("buttonCreate").disabled=false}if(!B){window.frames.right.location="dashboard.aspx?app="+C}window.frames.tree.location="TreeInit.aspx?app="+C;top.document.getElementById("treeWindowLabel").innerHTML=A;top.document.title=A+" - Umbraco CMS - "+window.location.hostname.toLowerCase().replace("www","");top.document.location.hash=C}function openDashboard(A){right.location.href="dashboard.aspx?app="+A}function syncTree(B,A,C,E){var D=B.split(",");tree.SyncTree(D,A,C,E)}function findNodeById(A){return findNodeByIdDo(tree.tree,A)}function findNodeByIdDo(B,E){var D=B.childNodes;if(D!=null){for(var A=0;A<D.length;A++){if(D[A].nodeID==E){return D[A]}else{if(D[A].childNodes!=null){var C=findNodeByIdDo(D[A],E);if(C!=""){return C}}}}}return""}var recycleBin;function updateRecycleBin(){recycleBin=findNodeById(-20);tree.jQuery("#"+recycleBin.id).effect("highlight",{},1000);if(recycleBin.src==""){recycleBin.src="tree.aspx?isRecycleBin=true&isDialog=&dialogMode=&app=content&id="+recycleBin.nodeID+"&treeType="+currentApp.toLowerCase();tree.document.getElementById(recycleBin.id+"-plus").src=recycleBin.plusIcon;recycleBin.folder=true;recycleBin.forceLoad(recycleBin.src,recycleBin)}else{recycleBin.src+="&rnd="+Math.random()*10;recycleBin.reload()}};