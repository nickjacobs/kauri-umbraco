if(parent.uiKeys!=undefined){webFXTreeConfig.loadingText=parent.uiKeys.general_pleasewait}else{webFXTreeConfig.loadingText="..."}webFXTreeConfig.loadErrorTextTemplate="";webFXTreeConfig.emptyErrorTextTemplate="";function WebFXLoadTree(D,G,A,I,F,B,J,H,C,E){this.WebFXTree=WebFXTree;this.WebFXTree(D,I,F,B,J,H,C,E);this.src=G;this.srcRoot=A;this.loading=false;this.loaded=false;this.errorText="";if(this.src!=""&&this.src!=null){if(this.open){_startLoadXmlTree(this.src,this)}else{this._loadingItem=new WebFXITreetem(webFXTreeConfig.loadingText);this.add(this._loadingItem)}}}WebFXLoadTree.prototype=new WebFXTree;WebFXLoadTree.prototype._webfxtree_expand=WebFXTree.prototype.expand;WebFXLoadTree.prototype.expand=function(){if(!this.loaded&&!this.loading){_startLoadXmlTree(this.src,this)}this._webfxtree_expand()};function WebFXLoadITreetem(D,J,E,L,I,B,N,K,C,A,H,F,M,G){this.WebFXITreetem=WebFXITreetem;this.WebFXITreetem(D,L,I,B,N,K,C,A,H,F,M);this.src=J;this.srcRoot=E;this.loading=false;this.loaded=false;this.errorText="";this.hasChildren=G;if(this.src!=null&&this.src!=""&&((K!="content"&&K!="media")||G=="true")){if(this.open){_startLoadXmlTree(this.src,this)}else{this._loadingItem=new WebFXITreetem(webFXTreeConfig.loadingText);this.add(this._loadingItem)}}}WebFXLoadITreetem.prototype=new WebFXITreetem;WebFXLoadITreetem.prototype._webfxITreetem_expand=WebFXITreetem.prototype.expand;WebFXLoadITreetem.prototype.expand=function(){if(!this.loaded&&!this.loading){_startLoadXmlTree(this.src,this)}this._webfxITreetem_expand()};WebFXLoadTree.prototype.reload=WebFXLoadITreetem.prototype.reload=function(){if(this.loaded){var A=this.open;while(this.childNodes.length>0){this.childNodes[this.childNodes.length-1].remove()}this.loaded=false;this._loadingItem=new WebFXITreetem(webFXTreeConfig.loadingText);this.add(this._loadingItem);if(A){this.expand()}}else{if(this.open&&!this.loading){_startLoadXmlTree(this.src,this)}}};WebFXLoadTree.prototype.forceLoad=WebFXLoadITreetem.prototype.forceLoad=function(){_startLoadXmlTree(this.src,this)};function _startLoadXmlTree(B,C){if(C.loading||C.loaded){return}C.loading=true;var A=XmlHttp.create();A.open("GET",B,true);A.onreadystatechange=function(){if(A.readyState==4){_xmlFileLoaded(A.responseXML,C)}};window.setTimeout(function(){A.send(null)},10)}function _xmlTreeToJsTree(K){var M=K.getAttribute("text");var P=K.getAttribute("action");var B=K.getAttribute("iconClass");var H=K.getAttribute("nodeType");var E=K.getAttribute("nodeID");var L=null;var R=K.getAttribute("icon").substring(0,1)=="."&&K.getAttribute("icon").substring(0,2)!=".."?K.getAttribute("icon").substring(1,K.getAttribute("icon").length):"images/umbraco/"+K.getAttribute("icon");var A=K.getAttribute("openIcon").substring(0,1)=="."&&K.getAttribute("openIcon").substring(0,2)!=".."?K.getAttribute("openIcon").substring(1,K.getAttribute("openIcon").length):"images/umbraco/"+K.getAttribute("openIcon");var J=K.getAttribute("src");var O=K.getAttribute("hasChildren");if(K.getAttribute("rootSrc")!=null){var F=K.getAttribute("rootSrc")}else{var F=null}if(K.getAttribute("menu")!=null){var C=K.getAttribute("menu")}else{var C=null}if(K.getAttribute("notPublished")!=null){var D=(K.getAttribute("notPublished").toLowerCase()=="true"||null)}else{var D=null}if(K.getAttribute("isProtected")!=null){var G=(K.getAttribute("isProtected").toLowerCase()=="true"||null)}else{var G=null}var S;if((J!=null&&J!="")||F!=null&&F!=""){S=new WebFXLoadITreetem(M,J,F,P,L,R,A,H,E,B,C,D,G,O)}else{S=new WebFXLoadITreetem(M,"","",P,L,R,A,H,E,B,C,D,G,O)}var I=K.childNodes;var N=I.length;for(var Q=0;Q<N;Q++){if(I[Q].tagName=="tree"){S.add(_xmlTreeToJsTree(I[Q]),true)}}return S}function _xmlFileLoaded(E,D){if(D.loaded){return}var A=false;var H=false;D.loaded=true;D.loading=false;if(E==null||E.documentElement==null){D.errorText=parseTemplateString(webFXTreeConfig.loadErrorTextTemplate,D.src)}else{var C=E.documentElement;var G=C.childNodes;var B=G.length;for(var F=0;F<B;F++){if(G[F].tagName=="tree"){H=true;A=true;D.add(_xmlTreeToJsTree(G[F]),true)}}if(!H){D.errorText=parseTemplateString(webFXTreeConfig.emptyErrorTextTemplate,D.src)}}if(D._loadingItem!=null){D._loadingItem.remove();A=true}if(A){D.indent()}if(D.errorText!=""){window.status=D.errorText}jQuery(document).trigger("xTreeNodeLoaded",this)}function parseTemplateString(C){var A=arguments;var D=C;D=D.replace(/\%\%/g,"%");for(var B=1;B<A.length;B++){D=D.replace(new RegExp("%"+B+"%","g"),A[B])}return D};