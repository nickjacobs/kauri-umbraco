cssFile="css/officexp.css";Menu.prototype.cssFile=cssFile;var tmp;var oldOpenState=null;var lastKeyCode=0;function rememberKeyCode(){lastKeyCode=window.event.keyCode}function showContextMenu(){if(parent.nodeID!="-1"&&parent.nodeType!=""){var D=window.event.srcElement;var C=null;var E=true;var G=", ";var A=false;while(D!=null&&D.tagName!="BODY"){if(D.tagName=="TABLE"){A=true}if(D.tagName=="IMG"||D.tagName=="DIV"){var B="";for(var K=0;K<D.attributes.length;K++){if(D.attributes[K].value!=""&&D.attributes[K].value!="null"){B+=D.attributes[K].name+": '"+D.attributes[K].value+"'\n"}}if(B.indexOf("<?UMBRACO_MACRO")>-1||B.indexOf("ismacro:")>-1){G=", MACRO, ";C=D;break}else{if(!A&&D.tagName!="DIV"){G+="IMG, "}}}else{if(!A&&D.tagName!="BODY"){G+=D.tagName+", "}}D=D.parentNode}var I=new Menu();if(G.indexOf(", IMG,")==-1&&G.indexOf(", MACRO,")==-1){I.add(resetItem=new MenuItem("Reset paragraph",function(){umbracoAlign(D,"")},"images/cMenu/editAlignReset.gif"));I.add(leftItem=new MenuItem("Align left",function(){umbracoAlign(D,"left")},"images/cMenu/editAlignLeft.gif"));I.add(centerItem=new MenuItem("Center",function(){umbracoAlign(D,"center")},"images/cMenu/editAlignCenter.gif"));I.add(rightItem=new MenuItem("Align right",function(){umbracoAlign(D,"right")},"images/cMenu/editAlignRight.gif"))}if(G.indexOf(", A,")>-1){I.add(new MenuSeparator());I.add(linkItem=new MenuItem("Edit Link",function(){umbracoEditA(D)},"images/cMenu/editA.gif"));linkItem.mnemonic="l"}if(G.indexOf(", IMG,")>-1){I.add(new MenuSeparator());I.add(resetItem=new MenuItem("Reset image",function(){umbracoAlign(D,"")},"images/cMenu/editAlignReset.gif"));I.add(leftItem=new MenuItem("Align image left",function(){umbracoAlign(D,"left")},"images/cMenu/editImageAlignLeft.gif"));I.add(rightItem=new MenuItem("Align image right",function(){umbracoAlign(D,"right")},"images/cMenu/editImageAlignRight.gif"))}if(G.indexOf(", MACRO,")>-1){I.add(new MenuSeparator());I.add(macroItem=new MenuItem("Edit Macro",function(){umbracoEditMacro(C)},"images/cMenu/editMacro.gif"));macroItem.mnemonic="m"}if(G.indexOf(", P,")>-1||G.indexOf(", SPAN,")>-1||G.indexOf(", DIV,")>-1){}if(G.indexOf(", TD,")>-1||G.indexOf(", TR,")>-1||G.indexOf(", TABLE,")>-1){I.add(new MenuSeparator());I.add(cellItem=new MenuItem("Insert row",function(){umbracoAddRow(D)},"images/cMenu/insrow.gif"));I.add(cellItem=new MenuItem("Insert column",function(){umbracoAddCol(D)},"images/cMenu/inscol.gif"));I.add(new MenuSeparator());I.add(cellItem=new MenuItem("Remove row",function(){umbracoDeleteRow(D)},"images/cMenu/delRow.gif"));I.add(cellItem=new MenuItem("Remove column",function(){umbracoDeleteCol(D)},"images/cMenu/delcol.gif"));I.add(new MenuSeparator());I.add(cellItem=new MenuItem("Split cells",function(){umbracoSplitCell(D)},"images/cMenu/spltCell.gif"));I.add(cellItem=new MenuItem("Collect cells",function(){umbracoGlueCell(D)},"images/cMenu/mrgCell.gif"));if(G.indexOf(", TD,")>-1){I.add(cellItem=new MenuItem("Edit Cell",function(){umbracoEditCell(D)},"/umbraco/images/cMenu/editcel.gif"));cellItem.mnemonic="c"}}var J=D!=null&&D.tagName=="A";if(J!=oldOpenState){oldOpenState=J}if(J){openItem.action=openNewWinItem.action=D.href}var F,H;if(E){D=window.event.srcElement}else{if(!J){D=document.documentElement}}if(lastKeyCode==93){F=posLib.getScreenLeft(D);H=posLib.getScreenTop(D)}else{F=window.event.screenX;H=window.event.screenY}I.invalidate();I.show(F,H);event.returnValue=false;lastKeyCode=0}}var functionsFrame=parent.parent.right;var tabFrame=functionsFrame;document.attachEvent("oncontextmenu",showContextMenu);