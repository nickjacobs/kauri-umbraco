var gPopupMask=null;var gPopupContainer=null;var gPopFrame=null;var gReturnFunc;var gPopupIsShown=false;var gHideSelects=false;var gTabIndexes=new Array();var gTabbableTags=new Array("A","BUTTON","TEXTAREA","INPUT","IFRAME");if(!document.all){document.onkeypress=keyDownHandler}function initPopUp(){theBody=document.getElementsByTagName("BODY")[0];popmask=document.createElement("div");popmask.id="popupMask";popcont=document.createElement("div");popcont.id="popupContainer";popcont.innerHTML='<div id="popupInner"><div id="popupTitleBar"><div id="popupTitle"></div><div id="popupControls"><img src="close.gif" onclick="hidePopWin(false);" /></div></div><iframe src="" style="background-color:transparent;" scrolling="auto" frameborder="0" allowtransparency="true" id="popupFrame" name="popupFrame" width="100%" height="100%"></iframe></div>';theBody.appendChild(popmask);theBody.appendChild(popcont);gPopupMask=document.getElementById("popupMask");gPopupContainer=document.getElementById("popupContainer");gPopFrame=document.getElementById("popupFrame");var A=parseInt(window.navigator.appVersion.charAt(0),10);if(A<=6&&window.navigator.userAgent.indexOf("MSIE")>-1){gHideSelects=true}}addEvent(window,"load",initPopUp);function showPopWin(B,E,A,C){gPopupContainer.style.width=E+"px";gPopupContainer.style.height=A+"px";gPopupIsShown=true;disableTabIndexes();gPopupMask.style.display="block";gPopupContainer.style.display="block";centerPopWin(E,A);var D=parseInt(document.getElementById("popupTitleBar").offsetHeight,10);setMaskSize();gPopFrame.style.width=(E)+"px";gPopFrame.style.height=(A)+"px";gPopFrame.src=B;gReturnFunc=C;if(gHideSelects==true){hideSelectBoxes()}gPopupMask.onclick=function(){hidePopWin(false)};window.setTimeout("setPopTitle();",600)}var gi=0;function centerPopWin(G,A){if(gPopupIsShown==true){if(G==null||isNaN(G)){G=gPopupContainer.offsetWidth}if(A==null){A=gPopupContainer.offsetHeight}var E=document.getElementsByTagName("BODY")[0];E.style.overflow="hidden";var B=parseInt(E.scrollTop,10);var D=parseInt(E.scrollLeft,10);gPopupMask.style.top=B+"px";gPopupMask.style.left=D+"px";setMaskSize();var F=parseInt(document.getElementById("popupTitleBar").offsetHeight,10);var C=getViewportHeight();var H=getViewportWidth();gPopupContainer.style.top=(B+((C-(A+F))/2))+"px";gPopupContainer.style.left=(D+((H-G)/2))+"px"}}addEvent(window,"resize",centerPopWin);window.onscroll=centerPopWin;function setMaskSize(){var B=document.getElementsByTagName("BODY")[0];var A=getViewportHeight();var C=getViewportWidth();if(A>B.scrollHeight){popHeight=A}else{popHeight=B.scrollHeight}gPopupMask.style.height=popHeight+"px";gPopupMask.style.width=B.scrollWidth+"px"}function hidePopWin(A,C){gPopupIsShown=false;restoreTabIndexes();if(gPopupMask==null){return}gPopupMask.style.display="none";gPopupContainer.style.display="none";if(A==true&&gReturnFunc!=null){gReturnFunc(C)}gPopFrame.src="";if(gHideSelects==true){displaySelectBoxes()}var B=document.getElementsByTagName("BODY")[0];B.style.overflow=""}function setPopTitle(){return;if(window.frames.popupFrame.document.title==null){window.setTimeout("setPopTitle();",10)}else{document.getElementById("popupTitle").innerHTML=window.frames.popupFrame.document.title}}function keyDownHandler(A){if(gPopupIsShown&&A.keyCode==9){return false}}function disableTabIndexes(){if(document.all){var C=0;for(var B=0;B<gTabbableTags.length;B++){var D=document.getElementsByTagName(gTabbableTags[B]);for(var A=0;A<D.length;A++){gTabIndexes[C]=D[A].tabIndex;D[A].tabIndex="-1";C++}}}}function restoreTabIndexes(){if(document.all){var C=0;for(var B=0;B<gTabbableTags.length;B++){var D=document.getElementsByTagName(gTabbableTags[B]);for(var A=0;A<D.length;A++){D[A].tabIndex=gTabIndexes[C];D[A].tabEnabled=true;C++}}}}function hideSelectBoxes(){for(var A=0;A<document.forms.length;A++){for(var B=0;B<document.forms[A].length;B++){if(document.forms[A].elements[B].tagName=="SELECT"){document.forms[A].elements[B].style.visibility="hidden"}}}}function displaySelectBoxes(){for(var A=0;A<document.forms.length;A++){for(var B=0;B<document.forms[A].length;B++){if(document.forms[A].elements[B].tagName=="SELECT"){document.forms[A].elements[B].style.visibility="visible"}}}};