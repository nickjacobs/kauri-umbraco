var isPasting=0;var isResizing=false;var resizeEl;var resizePosX,resizePosY;function openDialog(A,B,C,D){window.status="";strFeatures="dialogWidth="+C+"px;dialogHeight="+D+"px;scrollbars=no;center=yes;border=thin;help=no;status=no";strTitle=window.showModalDialog(B,"MyDialog",strFeatures);return strTitle}function handleBeforePaste(){event.returnValue=false}function handlePaste(){document.selection.clear();event.returnValue=false;setTimeout("doPaste();",5)}function doPaste(){var A=document.body.createTextRange();A.moveToElementText(document.getElementById("pasteHolder"));A.execCommand("Paste");A=document.getElementById("pasteHolder").innerHTML;if(A.indexOf("<FONT")>0||A.indexOf("MsoNormal")>0||A.indexOf("mso-")>0){action=openDialog("paste","dialogs/paste.aspx",520,400);if(action=="removeSpecial"){doPasteRemoveSpecial(A)}else{if(action=="removeAll"){doPasteText(A)}else{copyPasteContent(A)}}}else{copyPasteContent(A)}}function doPasteRemoveSpecial(A){A=A.replace(/<\/?SPAN[^>]*>/gi,"");A=A.replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3");A=A.replace(/<(\w[^>]*) style="([^"]*)"([^>]*)/gi,"<$1$3");A=A.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3");A=A.replace(/<\\?\?xml[^>]*>/gi,"");A=A.replace(/<\/?\w+:[^>]*>/gi,"");A=A.replace(/&nbsp;/," ");copyPasteContent(A)}function doPasteText(A){copyPasteContent(clipboardData.getData("Text").replace(/\n/g,"<BR/>"))}function copyPasteContent(B){var C=document.selection;if(C!=null){var A=C.createRange();if(A!=null){A.pasteHTML(B)}}}function umbracoImageResizeUpdateSize(A){if(isResizing){newWidth=(resizeEl.width<Math.abs(event.clientX-resizePosX))?0:resizeEl.width+(event.clientX-resizePosX);newHeight=(resizeEl.height<Math.abs(event.clientY-resizePosY))?0:resizeEl.height+(event.clientY-resizePosY);if(newWidth>resizeEl.umbracoOrgWidth||newHeight>resizeEl.umbracoOrgHeight){top.defaultStatus="Width: "+newWidth+", Height: "+newHeight+". "+parent.parent.uiKeys.errors_pictureResizeBiggerThanOrg}else{top.defaultStatus="Width: "+newWidth+", Height: "+newHeight}}}function umbracoImageResizeStart(A){A.umbracoBeforeResizeWidth=A.width;A.umbracoBeforeResizeHeight=A.height;isResizing=true;resizeEl=A;resizePosX=event.clientX;resizePosY=event.clientY;window.onmousemove=umbracoImageResizeUpdateSize()}function umbracoImageResize(D){isResizing=false;document.onmousemove="";var B=D.width;var J=D.height;var F=D.umbracoOrgWidth;var H=D.umbracoOrgHeight;var E=D.umbracoBeforeResizeWidth;var I=D.umbracoBeforeResizeHeight;var C=true;var A;var G;if(B>F||J>H){if(!confirm(parent.parent.uiKeys.errors_pictureResizeBiggerThanOrg)){G=E;A=I;C=false}}if(C){if(F>H){orgRatio=parseFloat(H/F).toFixed(2)}else{orgRatio=parseFloat(F/H).toFixed(2)}if(Math.abs(E-B)>Math.abs(I-J)){G=B;A=Math.round(B*parseFloat(H/F).toFixed(2))}else{G=Math.round(J*parseFloat(F/H).toFixed(2));A=J}}D.removeAttribute("style");D.removeAttribute("width");D.removeAttribute("height");D.setAttribute("width",G);D.setAttribute("height",A);if(D.umbracoOrgFileName){D.setAttribute("src",D.umbracoOrgFileName)}if(G!=F||A!=H){D.setAttribute("umbracoResizeImage",G+","+A)}}function cleanHTML(){if(document.body.innerHTML.indexOf("MsoNormal")>0||document.body.innerHTML.indexOf("mso-")>0){for(var B=0;B<document.all.length;B++){document.all[B].removeAttribute("className",0);document.all[B].removeAttribute("style",0)}var A=document.body.innerHTML;A=A.replace(/<\?xml:.*?\/>/g,"");A=A.replace(/<o:p>&nbsp;<\/o:p>/g,"");A=A.replace(/o:/g,"");A=A.replace(/<st1:.*?>/g,"");A=A.replace(/<\/FONT>/g,"");A=A.replace(/<FONT\/?.*?>/g,"");A=A.replace(/<\/SPAN>/g,"");A=A.replace(/<SPAN\/?.*?>/g,"");A=A.replace(/<p><\/p>/gi,"");document.body.innerHTML=A}}function umbracoReturnElementTag(B,A){while(B.tagName!=A&&B.tagName!="BODY"){B=B.parentNode}return B}function umbracoReturnAttributeNode(B,A){if(B.getAttributeNode(A)){return B.getAttributeNode(A).value}else{return""}}function umbracoUpdateAttribute(C,A,B){if(B!="''"&&B!=""){C.setAttribute(A,B)}else{C.removeAttribute(A)}}function umbracoIsArray(){if(typeof arguments[0]=="object"){var A=arguments[0].constructor.toString().match(/array/i);return(A!=null)}return false}function umbracoEditImg(A){alert("Endnu ikke klar :o)")}function umbracoEditClass(A){alert("Endnu ikke klar :o)")}function umbracoEditTable(B){var E=umbracoReturnElementTag(B,"TABLE");var A=umbracoReturnAttributeNode(E,"align");var F=umbracoReturnAttributeNode(E,"width");var C=umbracoReturnAttributeNode(E,"height");var G=umbracoReturnAttributeNode(E,"cellPadding");var D=umbracoReturnAttributeNode(E,"cellSpacing");var H=umbracoReturnAttributeNode(E,"border");var I=umbracoReturnAttributeNode(E,"class");var J=parent.openDialog("editTable","dialogs/insertTable.aspx?align="+escape(A)+"&width="+escape(F)+"&height="+escape(C)+"&padding="+escape(G)+"&spacing="+escape(D)+"&border="+escape(H)+"&class="+escape(I)+"&edit=true",470,520);umbracoUpdateAttribute(E,"align",J[0]);umbracoUpdateAttribute(E,"width",J[1]);umbracoUpdateAttribute(E,"height",J[2]);umbracoUpdateAttribute(E,"cellPadding",J[3]);umbracoUpdateAttribute(E,"cellSpacing",J[4]);umbracoUpdateAttribute(E,"border",J[5]);umbracoUpdateAttribute(E,"class",J[6])}function umbracoAddRow(F){var G=umbracoReturnElementTag(F,"TABLE");var E=0;var B=0;if(G.childNodes.length<2){G=umbracoReturnElementTag(F,"TBODY")}for(var C=0;C<G.childNodes.length;C++){for(var A=0;A<G.childNodes[C].cells.length;A++){E+=parseInt(G.childNodes[C].cells[A].getAttributeNode("colspan").value)}if(E>B){B=E}E=0}while(F.tagName!="TR"){F=F.parentElement}var H=F;var D=0;while(H.tagName=="TR"){H=H.previousSibling;if(!H){break}D++;if(!H.previousSibling){break}}if(F.tagName=="TR"){newRow=F.parentElement.insertRow(D);for(var C=0;C<B;C++){newRow.insertCell(C)}}}function umbracoDeleteRow(A){var C=umbracoReturnElementTag(A,"TABLE");if(C.childNodes.length<2){C=umbracoReturnElementTag(A,"TBODY")}while(A.tagName!="TR"){A=A.parentElement}var D=A;var B=0;while(D.tagName=="TR"){D=D.previousSibling;if(!D){break}B++;if(!D.previousSibling){break}}if(A.tagName=="TR"){A.parentElement.deleteRow(B)}}function umbracoDeleteCol(D){var E=umbracoReturnElementTag(D,"TABLE");if(E.childNodes.length<2){E=umbracoReturnElementTag(D,"TBODY")}while(D.tagName!="TD"){D=D.parentElement}var B=D;var A=0;while(B.tagName=="TD"){B=B.previousSibling;if(!B){break}A++;if(!B.previousSibling){break}}for(var C=0;C<E.childNodes.length;C++){if(E.childNodes[C].cells[A].getAttributeNode("colSpan").value>1){E.childNodes[C].cells[A].setAttribute("colSpan",parseInt(E.childNodes[C].cells[A].getAttributeNode("colSpan").value)-1)}else{E.childNodes[C].deleteCell(A)}}}function umbracoAddCol(C){var E=umbracoReturnElementTag(C,"TABLE");if(E.childNodes.length<2){E=umbracoReturnElementTag(C,"TBODY")}while(C.tagName!="TD"){C=C.parentElement}var A=C;var F=0;while(A.tagName=="TD"){A=A.previousSibling;if(!A){break}F++;if(!A.previousSibling){break}}for(var B=0;B<E.childNodes.length;B++){var D=document.createElement("TD");E.childNodes[B].insertBefore(D,E.childNodes[B].childNodes[F])}}function umbracoGlueCell(B){var C=umbracoReturnElementTag(B,"TD");if(C.nextSibling){var A=C.nextSibling.innerHTML;C.parentElement.removeChild(C.nextSibling);umbracoUpdateAttribute(C,"colSpan","2");C.innerHTML=C.innerHTML+A}else{alert(parent.uiKeys.tableColMergeLeft)}}function umbracoSplitCell(A){var C=umbracoReturnElementTag(A,"TD");var B=document.createElement("TD");if(parseInt(C.getAttributeNode("colSpan").value)<2){alert(parent.uiKeys.tableSplitNotSplittable)}else{umbracoUpdateAttribute(C,"colSpan","");C.parentElement.insertBefore(B,C)}}function umbracoEditCell(C){var J=umbracoReturnElementTag(C,"TD");if(C.getAttributeNode("width")){var E=C.getAttributeNode("width").value}else{var E=""}if(!parseInt(E)){E=""}if(C.getAttributeNode("align")){var I=C.getAttributeNode("align").value}else{var I=""}if(C.getAttributeNode("vAlign")){var F=C.getAttributeNode("vAlign").value}else{var F=""}var B=parent.openDialog("editCell","dialogs/editCell.aspx?width="+E+"&align="+I+"&valign="+F,480,340);B=B.split(",");if(B.length>1){var D=B[0];var H=B[1].replace(/\'/g,"");var A=B[2].replace(/\'/g,"");var G=B[3].replace(/\'/g,"");H=H.replace(/^\s+/g,"");A=A.replace(/^\s+/g,"");G=G.replace(/^\s+/g,"");if(D){if(parseInt(D)>0){J.setAttribute("width",D)}else{J.removeAttribute("width")}}else{if(D==""){J.removeAttribute("width")}}if(H){if(H!="''"&&H!=""){J.setAttribute("align",H)}else{J.removeAttribute("align")}}else{if(H==""){J.removeAttribute("align")}}if(A){if(A!="''"&&A!=""){J.setAttribute("vAlign",A)}else{J.removeAttribute("vAlign")}}else{if(A==""){J.removeAttribute("vAlign")}}if(G){if(G!="''"&&G!=""){C.style.cssText="background-color: #"+G}else{J.removeAttribute("Style")}}else{if(G==""){J.removeAttribute("Style")}}}}function umbracoAlign(A,B){var C;C=umbracoReturnElementTag(A,"IMG");if(C.tagName!="IMG"){C=umbracoReturnElementTag(A,"P")}if(C.tagName!="IMG"&&C.tagName!="P"){C=umbracoReturnElementTag(A,"TABLE")}A=C;if(A.tagName=="IMG"||A.tagName=="P"){if(B!=""){A.setAttribute("align",B)}else{A.removeAttribute("align")}}}function umbracoEditA(B){B=umbracoReturnElementTag(B,"A");var A=B.getAttributeNode("href").value;var C=B.getAttributeNode("target").value;linkToInsert=""+parent.openDialog("insertLink","dialogs/insertlink.aspx?linkName="+A+"&linkNewWindow="+C,440,480);linkToinsert=linkToInsert.toString();if(linkToInsert!="undefined"){if(linkToInsert.substr(0,4)=="true"){A=linkToInsert.substr(linkToInsert.indexOf("|")+1,linkToInsert.length);C="_blank"}else{A=linkToInsert.substr(linkToInsert.indexOf("|")+1,linkToInsert.length);C=""}if(A!=""){B.setAttribute("href",A);B.setAttribute("target",C)}else{B.removeNode(false)}}}function umbracoEditMacro(D){var C="";var B="";for(var A=0;A<D.attributes.length;A++){B=D.attributes[A].nodeName.toLowerCase();if(D.attributes[A].nodeValue&&(B!="ismacro"&&B!="style"&&B!="contenteditable")){C+=D.attributes[A].nodeName+"="+D.attributes[A].nodeValue.replace(/#/g,"%23").replace(/\</g,"%3C").replace(/\>/g,"%3E").replace(/\"/g,"%22")+"&"}}if(C.length>0){C=C.substr(0,C.length-1)}parent.macroEditElement=D;var E=parent.nytVindue("dialogs/editMacro.aspx?mode=edit&"+C,600,350)};